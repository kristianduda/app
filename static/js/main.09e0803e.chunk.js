(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{290:function(e){e.exports={table:{of:"of",rowsPerPage:"Rows per page:",previosPage:"Previous Page",nextPage:"Next Page",delete:"Delete",sure:"Are you sure?",selected:"Selected",filter:"Filter list",export:"Export",refresh:"Refresh list",sort:"Sort"},toolbar:{account:"Account",open:"Open drawer"},form:{save:"Save"}}},291:function(e){e.exports={table:{of:"z",rowsPerPage:"Z\xe1znamov:",previosPage:"Predch\xe1dzaj\xfaca strana",nextPage:"Nasleduj\xfaca strana",delete:"Zmazanie",sure:"Ste si ist\xfd?",selected:"zvolen\xfdch",filter:"Filtrova\u0165",export:"Exportova\u0165",refresh:"Obnovi\u0165",sort:"Triedi\u0165"},toolbar:{account:"\xda\u010det",open:"Otvori\u0165"},form:{save:"Ulo\u017ei\u0165"}}},344:function(e){e.exports={route:{records:"Records",clients:"Clients",projects:"Projects",reports:"Reports",events:"Events",enums:"Enums",calendar:"Calendar",sign:"Sign data",verify:"Verify data",project:"Project",login:"Login",oauth:"Auth",tags:"Tags",activities:"Activities",account:"Account"},activities:"Activities",typeId:"Type",opId:"Stats",groupId:"Group",months:"Months",years:"Years",user:"User",distance:"Distance",elevation:"Elevation",time:"Time",count:"Count",kudos:"Kudos",value:"Value",club:"Club",sex:"Sex",sync:"Sync",connect:"Connect",connected:"Connected apps",name:"Name",email:"Email",username:"Username",password:"Password",repeatedPassword:"Password again",otp:"2FA",generateSecret:"Generate secret",secret:"Secret",token:"Token",signIn:"Sign In",stravaSignIn:"Sign in with Strava",googleSignIn:"Sign in with Google",githubSignIn:"Sign in with Github",useAccount:"or use your account",totalDistance:"Total distance",totalElevation:"Total elevation",totalTime:"Total time",totalKudos:"Total kudos",maxDistance:"Max distance",maxElevation:"Max elevation",maxTime:"Max time",maxKudos:"Max kudos",thisWeek:"This week",lastWeek:"Last week",thisMonth:"This month",lastMonth:"Last month",thisYear:"This year",myMonths:"My months",myYears:"My years",all:"All",ride:"Ride",run:"Run",walk:"Walk",hike:"Hike",lastSync:"last sync",rideDes:"* bike distance calc as distance * 0.33",loading:"loading..."}},345:function(e){e.exports={route:{records:"Z\xe1znamy",clients:"Klienti",projects:"Projekty",reports:"Reporty",events:"Udalosti",enums:"\u010c\xedseln\xedky",calendar:"Kalend\xe1r",sign:"Podp\xedsa\u0165 d\xe1ta",verify:"Overi\u0165 d\xe1ta",project:"Projekt",login:"Prihl\xe1senie",oauth:"Autentifik\xe1cia",tags:"Zna\u010dky",activities:"Aktivity",account:"\xda\u010det"},activities:"Activity",typeId:"Typ",opId:"\u0160tatistiky",groupId:"Grupa",months:"Mesiace",years:"Roky",user:"Pou\u017e\xedvate\u013e",distance:"Vzdialenos\u0165",elevation:"V\xfd\u0161ka",time:"\u010cas",count:"Po\u010det",kudos:"Kudos",value:"Hodnota",club:"Klub",sex:"Pohlavie",sync:"Sync",connect:"Prepojenie",connected:"Prepojen\xe9 aplik\xe1cie",name:"Meno",email:"Email",username:"Meno",password:"Heslo",repeatedPassword:"Heslo znova",otp:"2FA",generateSecret:"Generova\u0165 secret",secret:"Secret",token:"Token",signIn:"Prihl\xe1senie",stravaSignIn:"Prihl\xe1senie so Strava",googleSignIn:"Prihl\xe1senie s Google",githubSignIn:"Prihl\xe1senie s Github",useAccount:"alebo pou\u017eite svoj \xfa\u010det",totalDistance:"Celkov\xe1 vzdialenos\u0165",totalElevation:"Celkov\xe1 v\xfd\u0161ka",totalTime:"Celkov\xfd \u010das",totalKudos:"Celkom kudos",maxDistance:"Maxim\xe1lna vzdielenos\u0165",maxElevation:"Maxim\xe1lna v\xfd\u0161ka",maxTime:"Maxim\xe1lny \u010das",maxKudos:"Maximum kudos",thisWeek:"Tento t\xfd\u017ede\u0148",lastWeek:"Minul\xfd t\xfd\u017ede\u0148",thisMonth:"Tento mesiac",lastMonth:"Minul\xfd mesiac",thisYear:"Tento rok",myMonths:"Moje mesiace",myYears:"Moje roky",all:"V\u0161etky",ride:"Bicykel",run:"Beh",walk:"Ch\xf4dza",hike:"Turistika",lastSync:"posledn\xe1 synchroniz\xe1cia",rideNote:"* vzdialenos\u0165 prejden\xe1 na bicykli r\xe1tan\xe1 ako vzdialenos\u0165 * 0.33",loading:"na\u010d\xedtavanie..."}},37:function(e){e.exports={url:{store:"https://stored.azurewebsites.net",auth:"https://storeauth.azurewebsites.net"},_github:{id:"c426e790821064328634"},_google:{id:"548560778490-kpllp0k9fhf7bdkfvlbjl0p4m88t0ipt.apps.googleusercontent.com"},strava:{id:"39689"},"2fa":!1,home:"/activities",configId:"5c606e8afb6fc06f052da3c9",palette:{type:"light",primary:{main:"#bd5d38"},secondary:{main:"#343a40"}},locale:"en-US"}},375:function(e,t,a){e.exports=a(753)},380:function(e,t,a){},731:function(e,t,a){},753:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a(12),s=a(14),i=a(13),c=a(15),l=a(0),o=a.n(l),u=a(43),p=a.n(u),d=(a(380),a(346)),h=a(148),f=a(47),m=a(339),v=a.n(m),b=a(38),g=a.n(b),w=a(340),y=a.n(w),x=a(9),E=a.n(x);function k(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}var O=o.a.createContext(),j=function(e){return function(t){return o.a.createElement(O.Consumer,null,function(a){return o.a.createElement(e,Object.assign({},t,{user:a}))})}},C=a(22),S=a(294),D=a.n(S),_=a(102),T=a.n(_),I=a(292),N=a.n(I),P=a(196),F=a.n(P),R=a(195),L=a.n(R),A=a(121),M=a.n(A),W=a(122),q=a.n(W),U=a(101),z=a.n(U),V=a(295),B=a.n(V),K=a(69),Y=a.n(K),G=a(26),H=a.n(G),Z=a(296),J=a.n(Z),X=a(70),$=a.n(X),Q=a(151),ee=a.n(Q),te=a(7),ae=a(149),ne=a.n(ae),re=a(32),se=a(49),ie=a.n(se),ce=a(290),le=a(291),oe=o.a.createContext(),ue=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).translate=function(e){return function(t){return ie.a.get(a.locales[e],t)}},a.locales={"en-US":Object(re.a)({},ce,e["en-US"]),"sk-SK":Object(re.a)({},le,e["sk-SK"])},a.state={locale:e.locale||"en-US"},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.children;return o.a.createElement(oe.Provider,{value:{locale:this.state.locale,translate:this.translate(this.state.locale)}},e)}}]),t}(o.a.Component),pe=function(e){return function(t){return o.a.createElement(oe.Consumer,null,function(a){return o.a.createElement(e,Object.assign({},t,a))})}},de=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleMenu=function(e){a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleClickAccount=function(){a.props.history.push("/account"),a.handleClose()},a.handleDrawerToggle=function(){a.setState(function(e){return{mobileOpen:!e.mobileOpen}})},a.redirect=function(e){Object(ae.isWidthDown)("md",a.props.width)&&a.handleDrawerToggle(),a.props.history.push(e.path)},a.state={mobileOpen:!1,anchorEl:null},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.theme,r=t.routes,s=t.user,i=t.translate,c=this.state.anchorEl,l=Boolean(c),u=this.props.history.location.pathname,p=r.find(function(e){return e.path===u}),d=o.a.createElement("div",null,o.a.createElement("div",{className:a.toolbar}),o.a.createElement(N.a,null),o.a.createElement(M.a,null,r.map(function(t){return!t.exact||t.hidden||t.permission&&!s.hasPermission(t.permission)?null:o.a.createElement(q.a,{button:!0,key:t.name,onClick:function(){return e.redirect(t)}},o.a.createElement(z.a,{primary:i("route."+t.name)||t.name}))})));return p&&p.anonymous?o.a.createElement("div",{className:a.root},this.props.children):o.a.createElement("div",{className:a.root},o.a.createElement(T.a,null),o.a.createElement(D.a,{position:"fixed",className:a.appBar},o.a.createElement(Y.a,null,o.a.createElement(g.a,{color:"inherit","aria-label":i("toolbar.open"),onClick:this.handleDrawerToggle,className:a.menuButton},o.a.createElement(B.a,null)),o.a.createElement(H.a,{variant:"h6",color:"inherit",noWrap:!0,className:a.grow},p?i("route."+p.name)||p.name:"App"),o.a.createElement("div",null,o.a.createElement("span",null,s.user?s.user.name:null),o.a.createElement(g.a,{"aria-owns":l?"menu-appbar":void 0,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},o.a.createElement(J.a,null)),o.a.createElement(ee.a,{id:"menu-appbar",anchorEl:c,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:this.handleClose},o.a.createElement($.a,{onClick:this.handleClickAccount},i("toolbar.account")))))),o.a.createElement("nav",{className:a.drawer},o.a.createElement(L.a,{lgUp:!0,implementation:"css"},o.a.createElement(F.a,{variant:"temporary",anchor:"rtl"===n.direction?"right":"left",open:this.state.mobileOpen,onClose:this.handleDrawerToggle,classes:{paper:a.drawerPaper}},d)),o.a.createElement(L.a,{mdDown:!0,implementation:"css"},o.a.createElement(F.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0},d))),o.a.createElement("main",{className:a.content},o.a.createElement("div",{className:a.toolbar}),this.props.children))}}]),t}(o.a.Component),he=k(ne()(),Object(te.withStyles)(function(e){return{root:{display:"flex"},grow:{flexGrow:1},drawer:Object(C.a)({},e.breakpoints.up("lg"),{width:240,flexShrink:0}),appBar:Object(C.a)({marginLeft:240},e.breakpoints.up("lg"),{width:"calc(100% - ".concat(240,"px)")}),menuButton:Object(C.a)({marginRight:20},e.breakpoints.up("lg"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:240},content:{flexGrow:1,padding:2*e.spacing.unit,overflow:"auto"}}},{withTheme:!0}),f.f,pe)(de),fe=a(25),me=a.n(fe),ve=a(24),be=a.n(ve),ge=a(3),we=a.n(ge),ye=a(5),xe=a(109);var Ee=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:160}}})(function(e){var t=e.classes;return o.a.createElement(xe.a,{className:t.formControl,keyboard:!0,label:e.label,format:"MM/DD/YYYY",clearable:!e.required,mask:function(e){return e?[/\d/,/\d/,"/",/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/]:[]},value:e.value||null,onChange:function(t){return e.onChange(e.field,t?t.toDate():null)},disableOpenOnEnter:!0,animateYearScrolling:!1,style:{flex:1,display:"flex"},disabled:e.disabled})}),ke=a(58),Oe=a.n(ke),je=a(55),Ce=a.n(je),Se=a(57),De=a.n(Se);var _e=pe(Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:100}}})(function(e){var t=e.classes,a=e.label||e.translate(e.field);return o.a.createElement(Oe.a,{className:t.formControl,fullWidth:e.fullWidth,required:e.required},o.a.createElement(De.a,{htmlFor:e.field},a),o.a.createElement(Ce.a,{type:"new-password"===e.type?"password":e.type,id:e.field,value:e.value||"",onChange:function(t){return e.onChange(e.field,t.target.value)},placeholder:e.placeholder,autoComplete:"new-password"===e.type?"new-password":null,disabled:e.disabled,multiline:e.multiline,rows:e.rows,startAdornment:e.startAdornment}))}));var Te=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWwidth:80}}})(function(e){var t=e.classes;return o.a.createElement(Oe.a,{className:t.formControl,required:e.required,fullWidth:e.fullWidth},o.a.createElement(De.a,{htmlFor:e.field},e.label),o.a.createElement(Ce.a,{id:e.field,value:e.value?e.value.toString():"0",onChange:function(t){return e.onChange(e.field,Number(t.target.value))},type:"number",disabled:e.disabled,inputProps:{min:e.min,max:e.max,step:e.step}}))}),Ie=a(147),Ne=a.n(Ie),Pe=a(103),Fe=a.n(Pe);var Re=pe(Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:120}}})(function(e){var t=e.classes,a=e.data,n=e.textField,r=e.required,s=e.value,i=e.onChange,c=e.field,l=e.multiple;r&&null===s&&a&&a.length>0&&i(c,a[0]._id);var u=function(e){var t=a.find(function(t){return t._id===e});return t?t[n]:null},p=e.label||e.translate(e.field);return o.a.createElement(Oe.a,{className:t.formControl,required:r,fullWidth:e.fullWidth},p&&o.a.createElement(De.a,{htmlFor:e.field},p),o.a.createElement(Ne.a,{value:null!==e.value?e.value:"",onChange:function(t){return i(e.field,t.target.value)},id:e.field,multiple:e.multiple,renderValue:function(e){return l?e.map(function(e){return u(e)}).join(" | "):u(e)},disabled:e.disabled},!e.required&&!l&&o.a.createElement($.a,{value:""},o.a.createElement("em",null,"None")),a.map(function(e){return o.a.createElement($.a,{key:e._id,value:e._id},l&&o.a.createElement(Fe.a,{checked:void 0!==s.find(function(t){return t===e._id})}),o.a.createElement(z.a,{primary:e[n]}))})))})),Le=a(35),Ae=a.n(Le),Me=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=function(e){e.preventDefault(),a.props.onSubmit()},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.inline,n=e.disabled,r=e.translate;return o.a.createElement("form",{className:a?t.formInline:t.form,onSubmit:this.handleSubmit},this.props.children,!n&&o.a.createElement(Ae.a,{className:t.submitButton,type:"submit",variant:"contained",color:"primary",disabled:n},r("form.save")))}}]),t}(o.a.Component),We=pe(Object(te.withStyles)(function(e){return{formInline:{display:"flex",flexWrap:"wrap",flexDirection:"row"},form:{display:"flex",flexDirection:"column"},submitButton:{margin:e.spacing.unit}}})(Me)),qe=o.a.createContext(),Ue=function(e){return function(t){return o.a.createElement(qe.Consumer,null,function(a){return o.a.createElement(e,Object.assign({},t,{store:a}))})}},ze={date:new Date,name:"",duration:0,projectId:null,taskId:null},Ve=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||ze,a.handleChangeProject=function(e,t){var n=a.props.user.user,r=a.props.store,s=r.getOpenedTasks,i=r.handleChange;s(t,n),a.props.data||i(e,t),a.handleChange(e,t)},a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addTimeRecord,r=t.refreshTimeRecords,s=t.editTimeRecord,i=a.props.user.user,a.state.projectId){e.next=4;break}return e.abrupt("return");case 4:if(e.prev=4,!a.state._id){e.next=10;break}return e.next=8,s(a.state,i);case 8:e.next=12;break;case 10:return e.next=12,n(a.state,i);case 12:r(),a.setState(ze),a.props.onSubmit&&a.props.onSubmit(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),a.props.user.showError(e.t0);case 20:case"end":return e.stop()}},e,null,[[4,17]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.date,n=t.name,r=t.duration,s=t.projectId,i=t.taskId,c=this.props.store,l=c.projects,u=c.tasks;return o.a.createElement(We,{onSubmit:this.handleSubmit,inline:!0},o.a.createElement("div",{className:e.nameTextInput},o.a.createElement(_e,{label:"Name",value:n,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0})),o.a.createElement(Re,{label:"Project",value:s,field:"projectId",onChange:this.handleChangeProject,data:l.data,textField:"name",required:!0}),o.a.createElement(Re,{label:"Task",value:i,field:"taskId",onChange:this.handleChange,data:u.data,textField:"name"}),o.a.createElement(Ee,{label:"Date",value:a,field:"date",onChange:this.handleChange,required:!0}),o.a.createElement(Te,{label:"Duration",value:r,field:"duration",onChange:this.handleChange,min:0,step:.25,required:!0}))}}]),t}(o.a.Component),Be=k(Object(te.withStyles)(function(e){return{nameTextInput:{display:"flex",flex:1}}}),Ue,j)(Ve),Ke=a(45),Ye=a(310),Ge=a.n(Ye),He=a(311),Ze=a.n(He),Je=a(64),Xe=a.n(Je),$e=a(312),Qe=a.n($e),et=a(123),tt=a.n(et),at=a(302),nt=a.n(at),rt=a(303),st=a.n(rt),it=a(48),ct=a.n(it),lt=pe(function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.onSelectAllClick,n=t.sort,r=t.numSelected,s=t.rowCount,i=t.rows,c=t.sortable,l=t.translate;return o.a.createElement(nt.a,null,o.a.createElement(tt.a,null,o.a.createElement(Xe.a,{padding:"checkbox"},o.a.createElement(Fe.a,{indeterminate:r>0&&r<s,checked:r===s,onChange:a})),i.map(function(t){return o.a.createElement(Xe.a,{key:t.field,align:"num"===t.type?"right":"left",padding:t.disablePadding?"none":"default",sortDirection:n.field===t.field&&n.dir},!1===c||!1===t.sortable?t.label:o.a.createElement(ct.a,{title:l("table.sort"),placement:"num"===t.type?"bottom-end":"bottom-start",enterDelay:300},o.a.createElement(st.a,{active:n.field===t.field,direction:n.dir,onClick:e.createSortHandler(t.field)},t.label)))},this),o.a.createElement(Xe.a,{padding:"none"})))}}]),t}(o.a.Component)),ot=a(6),ut=a.n(ot),pt=a(304),dt=a.n(pt),ht=a(305),ft=a.n(ht),mt=a(153),vt=a.n(mt),bt=a(154),gt=a.n(bt),wt=a(62),yt=pe(Object(te.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(wt.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 auto"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}})(function(e){var t=e.numSelected,a=e.classes,n=e.onDelete,r=e.onFilter,s=e.title,i=e.onExport,c=e.isFilterSet,l=e.actions,u=e.onRefresh,p=e.exportDisabled,d=e.translate;return o.a.createElement(Y.a,{className:ut()(a.root,Object(C.a)({},a.highlight,t>0))},o.a.createElement("div",{className:a.title},t>0?o.a.createElement(H.a,{color:"inherit",variant:"subtitle1"},t," ",d("table.selected")):o.a.createElement(H.a,{variant:"h6",id:"tableTitle"},s)),o.a.createElement("div",{className:a.spacer}),o.a.createElement("div",{className:a.actions},l,t>0?o.a.createElement(ct.a,{title:d("table.delete")},o.a.createElement(g.a,{"aria-label":d("table.delete"),onClick:n},o.a.createElement(dt.a,null))):o.a.createElement(ct.a,{title:d("table.filter")},o.a.createElement(g.a,{"aria-label":d("table.filter"),color:c?"primary":"default",onClick:r},o.a.createElement(vt.a,null))),o.a.createElement(ct.a,{title:d("table.export")},o.a.createElement(g.a,{"aria-label":d("table.export"),onClick:i,disabled:p},o.a.createElement(ft.a,null))),o.a.createElement(ct.a,{title:d("table.refresh")},o.a.createElement(g.a,{"aria-label":d("table.refresh"),onClick:u},o.a.createElement(gt.a,null)))))})),xt=a(63),Et=a.n(xt),kt=a(77),Ot=a.n(kt),jt=a(152),Ct=a.n(jt),St=a(306),Dt=a.n(St),_t=a(78),Tt=a.n(_t);var It=function(e){return o.a.createElement(Et.a,{open:e.isOpen,onClose:e.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},o.a.createElement(Tt.a,{id:"alert-dialog-title"},e.title),o.a.createElement(Ct.a,null,o.a.createElement(Dt.a,{id:"alert-dialog-description"},e.description)),o.a.createElement(Ot.a,null,o.a.createElement(Ae.a,{onClick:e.onClose,color:"primary"},"Cancel"),o.a.createElement(Ae.a,{onClick:e.onConfirm,color:"primary",autoFocus:!0},"OK")))},Nt=a(23),Pt=a.n(Nt),Ft=function(e,t,a){var n,r,s=[];a&&(t.forEach(function(e){r=e.field,(n=a[r])&&s.push.apply(s,Object(Ke.a)(e.data.find(function(e){return e._id===n}).filters))}),e.forEach(function(e){switch(e.type){case"num":r=e.field,(n=a[r])&&s.push({field:r,op:"eq",value:n});break;case"bool":r=e.field,(n=a[r])&&s.push({field:r,op:"eq",value:1===n});break;case"date":case"datetime":r=e.field,(n=a[r])&&(s.push({field:r,op:"lte",value:Pt()(n).endOf("day").toDate()}),s.push({field:r,op:"gte",value:Pt()(n).startOf("day").toDate()}));break;case"enum":r=e.idField,(n=a[r])&&n.length>0&&s.push({field:r,op:"in",value:n});break;default:r=e.field,(n=a[r])&&s.push({field:r,op:"regex",value:n})}}));return s},Rt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleClear=function(){var e={};a.props.filters.forEach(function(t){e[t.field]=null}),a.props.rows.forEach(function(t){var a="enum"===t.type?t.idField:t.field;e[a]=null}),a.props.onConfirm(null),a.setState(e)},a.handleSubmit=function(){a.props.onConfirm(a.state)},a.buildFilter=function(e){if(!1===e.filterable)return null;switch(e.type){case"enum":var t=e.field.split(".").pop();return o.a.createElement(Re,{key:e.label,label:e.label,value:a.state[e.idField]||[],field:e.idField,onChange:a.handleChange,data:a.props.store[e.data].data,textField:t,multiple:!0});case"bool":return o.a.createElement(Re,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange,data:[{_id:1,name:"T"},{_id:-1,name:"F"}],textField:"name"});case"date":case"datetime":return o.a.createElement(Ee,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange});case"num":return o.a.createElement(Te,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange,min:0});default:return o.a.createElement(_e,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange})}},a.state=e.defaultState||{},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props;return o.a.createElement(Et.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:t.isOpen,onClose:t.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0},o.a.createElement(Tt.a,{id:"alert-dialog-title"},"Filters"),this.props.filters.map(function(t){return o.a.createElement(Re,{value:e.state[t.field],field:t.field,label:t.label,onChange:e.handleChange,data:t.data,textField:"name"})}),t.rows.map(function(t){return e.buildFilter(t)}),o.a.createElement(Ot.a,null,o.a.createElement(Ae.a,{onClick:this.handleClear,color:"primary"},"Clear"),o.a.createElement(Ae.a,{onClick:this.handleSubmit,color:"primary",autoFocus:!0},"OK")))}}]),t}(o.a.Component),Lt=a(307),At=a.n(Lt),Mt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={anchorEl:null,isOpenDelete:!1},a.handleOpenMenu=function(e){a.setState({anchorEl:e.currentTarget})},a.handleCloseMenu=function(){a.setState({anchorEl:null})},a.handleCloseDelete=function(){a.setState({isOpenDelete:!1})},a.handleOpenDelete=function(){a.setState({isOpenDelete:!0,anchorEl:null})},a.onDelete=function(){a.props.onDelete(),a.handleCloseDelete()},a.onEdit=function(){a.props.onEdit(),a.handleCloseMenu()},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.anchorEl,a=e.isOpenDelete;return o.a.createElement("div",null,o.a.createElement(g.a,{"aria-owns":t?"actions-menu":void 0,"aria-haspopup":"true",edge:"end","aria-label":"actions",onClick:this.handleOpenMenu,disabled:this.props.disabled},o.a.createElement(At.a,null)),o.a.createElement(ee.a,{id:"actions-menu",anchorEl:t,open:Boolean(t),onClose:this.handleCloseMenu},o.a.createElement($.a,{onClick:this.onEdit},"Edit"),o.a.createElement($.a,{onClick:this.handleOpenDelete},"Delete")),o.a.createElement(It,{isOpen:a,onClose:this.handleCloseDelete,onConfirm:this.onDelete,title:"Delete",description:"Are you sure?"}))}}]),t}(o.a.Component),Wt=a(308),qt=a.n(Wt);var Ut=Object(te.withStyles)(function(e){return{progress:{backgroundColor:"white",opacity:.8,position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1800,display:"flex",justifyContent:"center",alignItems:"center"}}})(function(e){var t=e.classes;return e.isLoading?o.a.createElement("div",{className:t.progress},o.a.createElement(qt.a,null)):null}),zt=a(309),Vt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleRequestSort=function(e,t){var n=t,r="desc";a.state.sort.field===t&&"desc"===a.state.sort.dir&&(r="asc");var s={field:n,dir:r},i=a.state,c=i.filters,l=i.page,o=i.rowsPerPage;a.onChange(c,l,o,s),a.setState({sort:s})},a.handleSelectAllClick=function(e){if(e.target.checked){var t=a.props.store[a.props.data].data;a.setState(function(e){return{selected:t.filter(function(e){return!1===a.props.isDisabled(e)}).map(function(e){return e._id})}})}else a.setState({selected:[]})},a.handleClick=function(e){var t=a.state.selected,n=t.indexOf(e),r=[];-1===n?r=r.concat(t,e):0===n?r=r.concat(t.slice(1)):n===t.length-1?r=r.concat(t.slice(0,-1)):n>0&&(r=r.concat(t.slice(0,n),t.slice(n+1))),a.setState({selected:r})},a.handleChangePage=function(e,t){var n=a.state,r=n.filters,s=n.rowsPerPage,i=n.sort;a.onChange(r,t,s,i),a.setState({page:t})},a.handleChangeRowsPerPage=function(e){var t=e.target.value,n=a.state,r=n.filters,s=n.page,i=n.sort;a.onChange(r,s,t,i),a.setState({rowsPerPage:t})},a.isSelected=function(e){return-1!==a.state.selected.indexOf(e)},a.onChange=function(e,t,n,r){a.props.onChange(e,{limit:n,skip:n*t},r)},a.componentDidMount=function(){var e=a.state,t=e.filters,n=e.page,r=e.rowsPerPage,s=e.sort;a.onChange(t,n,r,s)},a.handleOpenFilter=function(){a.setState({isOpenFilter:!0})},a.handleCloseFilter=function(){a.setState({isOpenFilter:!1})},a.handleConfirmFilter=function(e){var t=Ft(a.props.rows,a.props.filters,e),n=a.state,r=n.rowsPerPage,s=n.sort;a.onChange(t,0,r,s),a.setState({filters:t,page:0,isOpenFilter:!1})},a.onDeleteMultiple=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i,c;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.selected,r=t.filters,s=t.page,i=t.rowsPerPage,c=t.sort,e.next=3,Promise.all(n.map(function(e){return a.props.onDelete(e)}));case 3:a.onChange(r,s,i,c),a.setState({selected:[]}),a.handleCloseDelete();case 6:case"end":return e.stop()}},e)})),a.strToDate=function(e){return new Date(e).toLocaleDateString(a.props.locale)},a.strToDateTime=function(e){return new Date(e).toLocaleString(a.props.locale,{hour12:!1,year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})},a.getValue=function(e,t){var n=ie.a.get(e,t.field);if(t.cell)return t.cell(e);switch(t.type){case"date":return a.strToDate(n);case"datetime":return a.strToDateTime(n);case"bool":return n?"T":"F";default:return n}},a.onDeleteSingle=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n,r,s,i,c;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,r=n.filters,s=n.page,i=n.rowsPerPage,c=n.sort,e.next=3,a.props.onDelete(t);case 3:a.onChange(r,s,i,c);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleCloseDelete=function(){a.setState({isOpenDelete:!1})},a.handleOpenDelete=function(){a.setState({isOpenDelete:!0})},a.onExport=Object(ye.a)(we.a.mark(function e(){var t,n,r,s;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.filters,r=t.sort,e.next=3,a.props.onChange(n,void 0,r);case 3:(s=e.sent)&&(a.setState({exported:s.data}),a.exportRef.current.link.click());case 5:case"end":return e.stop()}},e)})),a.handleRefresh=function(){var e=a.state,t=e.filters,n=e.page,r=e.rowsPerPage,s=e.sort;a.onChange(t,n,r,s)},a.state={selected:[],page:0,rowsPerPage:5,filters:Ft(e.rows,e.filters,e.defaultFilters),sort:e.defaultSort||{field:"_id",dir:"asc"},isOpenDelete:!1,isOpenFilter:!1,filter:null,exported:[]},a.exportRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.rows,r=t.sortable,s=t.title,i=t.translate,c=this.state,l=c.selected,u=c.rowsPerPage,p=c.page,d=c.sort,h=c.isOpenDelete,f=c.isOpenFilter,m=this.props.store[this.props.data],v=u-Math.min(u,m.total-p*u),b=this.props.filename||"data";return o.a.createElement(be.a,{className:a.root},o.a.createElement(yt,{numSelected:l.length,onDelete:this.handleOpenDelete,onExport:this.onExport,onFilter:this.handleOpenFilter,title:s,isFilterSet:this.state.filters.length>0,actions:this.props.actions,onRefresh:this.handleRefresh,exportDisabled:!this.props.headers}),o.a.createElement("div",{className:a.tableWrapper},o.a.createElement(Ut,{isLoading:m.isLoading}),o.a.createElement(Ge.a,{className:a.table,"aria-labelledby":"tableTitle",size:"small"},o.a.createElement(lt,{numSelected:l.length,sort:d,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:m.total,rows:n,sortable:r}),o.a.createElement(Ze.a,null,m.data.map(function(t){var a=e.isSelected(t._id),r=e.props.isDisabled(t);return o.a.createElement(tt.a,{hover:!0,role:"checkbox","aria-checked":a,tabIndex:-1,key:t._id,selected:a},o.a.createElement(Xe.a,{padding:"checkbox"},o.a.createElement(Fe.a,{checked:a,onClick:function(a){return e.handleClick(t._id)},disabled:r})),n.map(function(a){return o.a.createElement(Xe.a,{key:a.field,align:"num"===a.type?"right":"left",padding:a.disablePadding?"none":"default"},e.getValue(t,a))}),o.a.createElement(Xe.a,null,o.a.createElement(Mt,{onDelete:function(){return e.onDeleteSingle(t._id)},onEdit:function(){return e.props.onEdit(t)},disabled:r})))}),v>0&&o.a.createElement(tt.a,{style:{height:49*v}},o.a.createElement(Xe.a,{colSpan:6}))))),o.a.createElement(Qe.a,{labelRowsPerPage:i("table.rowsPerPage"),labelDisplayedRows:function(e){var t=e.from,a=e.to,n=e.count;return"".concat(t,"-").concat(a," ").concat(i("table.of")," ").concat(n)},rowsPerPageOptions:[5,10,25],component:"div",count:m.total,rowsPerPage:u,page:p,backIconButtonProps:{"aria-label":i("table.previousPage")},nextIconButtonProps:{"aria-label":i("table.nextPage")},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}),o.a.createElement(It,{isOpen:h,onClose:this.handleCloseDelete,onConfirm:this.onDeleteMultiple,title:i("table.delete"),description:i("table.sure")}),o.a.createElement(Rt,{isOpen:f,onClose:this.handleCloseFilter,onConfirm:this.handleConfirmFilter,store:this.props.store,rows:this.props.rows,filters:this.props.filters,defaultState:this.props.defaultFilters}),o.a.createElement(zt.CSVLink,{data:this.state.exported,headers:this.props.headers,filename:"".concat(b,".csv"),style:{display:"none"},ref:this.exportRef,target:"_blank"}))}}]),t}(o.a.Component),Bt=pe(Object(te.withStyles)(function(e){return{root:{width:"100%"},table:{},tableWrapper:{overflowX:"auto",position:"relative"}}})(Vt));var Kt,Yt=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,width:160}}})(function(e){return o.a.createElement(Et.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:e.isOpen,fullWidth:!0},o.a.createElement(Tt.a,{id:"simple-dialog-title"},e.title),e.children)}),Gt=function(e){return[{field:"name",disablePadding:!0,label:"Name"},{field:"date",type:"date",label:"Date"},{field:"_project.name",label:"Project",type:"enum",data:"projects",idField:"projectId"},{field:"_task.name",label:"Task",type:"enum",data:"tasks",idField:"taskId",filterable:!1},{field:"_user.name",label:"User",type:"enum",data:"users",idField:"userId",filterable:void 0===e.find(function(e){return"userId"===e.field})},{field:"duration",type:"num",label:"Duration",filterable:!1}]},Ht=[{label:"Name",key:"name"},{label:"Date",key:"date"},{label:"Project",key:"project.name"},{label:"Task",key:"task.name"},{label:"User",key:"user.name"},{label:"Duration",key:"duration"}],Zt=[{label:"Period",field:"period",data:[{_id:1,name:"today",filters:[{field:"date",op:"lte",value:Pt()().endOf("day").toDate()},{field:"date",op:"gte",value:Pt()().startOf("day").toDate()}]},{_id:2,name:"this week",filters:[{field:"date",op:"lte",value:Pt()().endOf("week").toDate()},{field:"date",op:"gte",value:Pt()().startOf("week").toDate()}]},{_id:3,name:"last week",filters:[{field:"date",op:"lte",value:Pt()().subtract(1,"weeks").endOf("week").toDate()},{field:"date",op:"gte",value:Pt()().subtract(1,"weeks").startOf("week").toDate()}]},{_id:4,name:"this month",filters:[{field:"date",op:"lte",value:Pt()().endOf("month").toDate()},{field:"date",op:"gte",value:Pt()().startOf("month").toDate()}]},{_id:5,name:"last month",filters:[{field:"date",op:"lte",value:Pt()().subtract(1,"month").endOf("month").toDate()},{field:"date",op:"gte",value:Pt()().subtract(1,"month").startOf("month").toDate()}]},{_id:6,name:"this year",filters:[{field:"date",op:"lte",value:Pt()().endOf("year").toDate()},{field:"date",op:"gte",value:Pt()().startOf("year").toDate()}]},{_id:7,name:"last year",filters:[{field:"date",op:"lte",value:Pt()().subtract(1,"year").endOf("month").toDate()},{field:"date",op:"gte",value:Pt()().subtract(1,"year").startOf("year").toDate()}]}]}],Jt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleClose=function(){var e=a.props.user.user,t=a.props.store,n=t.projectId;(0,t.getOpenedTasks)(n,e),a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(ye.a)(we.a.mark(function e(t,n){var r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=[].concat(Object(Ke.a)(a.props.filters),Object(Ke.a)(t)),e.next=4,a.props.store.getTimeRecords(r,n);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),a.props.user.showError(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),a.onEdit=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.user.user,e.next=3,a.props.store.getOpenedTasks(t.projectId,n);case 3:a.setState({x:t,isOpen:!0});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a.state={x:null,isOpen:!1},Kt=Gt(e.filters),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(ye.a)(we.a.mark(function e(){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{this.props.store.getClients()}catch(t){this.props.user.showError(t)}case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.store.deleteTimeRecord;return o.a.createElement("div",null,o.a.createElement(Bt,{rows:Kt,data:"timeRecords",onChange:this.handleChange,sortable:!1,onDelete:e,title:"Time records",onEdit:this.onEdit,store:this.props.store,filters:Zt,defaultFilters:this.props.defaultFilters,isDisabled:this.isDisabled,headers:Ht}),o.a.createElement(Yt,{title:"Edit time record",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(Be,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),Xt=k(Ue,j)(Jt);var $t=k(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),j)(function(e){var t=e.user.user;return o.a.createElement(me.a,{container:!0,spacing:16},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(be.a,{className:e.classes.paper},o.a.createElement(Be,null))),o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(Xt,{filters:[{field:"userId",value:t._id}]})))}),Qt=a(104),ea=a.n(Qt),ta=a(155),aa=a.n(ta),na=a(37),ra=a(41),sa=a.n(ra);var ia=function(e){return o.a.createElement(sa.a,e,o.a.createElement("path",{d:"M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"}))},ca=function(e){return na.github?o.a.createElement(Ae.a,{fullWidth:e.fullWidth,variant:"outlined",color:"primary",tooltip:"Github",onClick:function(){var e="https://github.com/login/oauth/authorize?client_id=".concat(na.github.id,"&scope=user&redirect_uri=").concat("https://vypadnivon.sk","?provider=1");window.location.replace(e)},disabled:e.disabled},o.a.createElement(ia,{fontSize:"large"})," ",o.a.createElement("span",{style:{width:200}},e.title)):null};var la=function(e){return o.a.createElement(sa.a,e,o.a.createElement("path",{d:"M21.35,11.1H12.18V13.83H18.69C18.36,17.64 15.19,19.27 12.19,19.27C8.36,19.27 5,16.25 5,12C5,7.9 8.2,4.73 12.2,4.73C15.29,4.73 17.1,6.7 17.1,6.7L19,4.72C19,4.72 16.56,2 12.1,2C6.42,2 2.03,6.8 2.03,12C2.03,17.05 6.16,22 12.25,22C17.6,22 21.5,18.33 21.5,12.91C21.5,11.76 21.35,11.1 21.35,11.1V11.1Z"}))},oa=function(e){return na.google?o.a.createElement(Ae.a,{fullWidth:e.fullWidth,variant:"outlined",color:"primary",onClick:function(){var e="https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/userinfo.profile&redirect_uri=".concat("https://vypadnivon.sk","?provider=2&response_type=code&client_id=").concat(na.google.id);window.location.replace(e)},disabled:e.disabled},o.a.createElement(la,{fontSize:"large"})," ",o.a.createElement("span",{style:{width:200}},e.title)):null};var ua=function(e){return o.a.createElement(sa.a,e,o.a.createElement("path",{d:"M14.92 17.16l1.83-3.63h2.7l-4.51 8.97l-4.57-8.97h2.7l1.85 3.63m-4.29-8.5l-2.45 4.89H4.55L10.61 1.5l6.13 12.05h-3.63l-2.48-4.89z"}))},pa=function(e){return na.strava?o.a.createElement(Ae.a,{fullWidth:e.fullWidth,variant:"outlined",color:"primary",onClick:function(){var e="https://www.strava.com/oauth/authorize?client_id=".concat(na.strava.id,"&response_type=code&scope=read,activity:read&redirect_uri=").concat("https://vypadnivon.sk","?provider=4");window.location.replace(e)},disabled:e.disabled},o.a.createElement(ua,{fontSize:"large"})," ",o.a.createElement("span",null,e.title)):null};function da(){return o.a.createElement(H.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",o.a.createElement(aa.a,{color:"inherit",href:"https://vypadnivon.sk"},"VYPADNI VON")," ",(new Date).getFullYear(),".")}var ha=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleSubmit=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n,r,s,i;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({disabled:!0}),n=a.state,r=n.username,s=n.password,i=n.token,e.prev=3,e.next=6,a.props.user.auth(r.trim().toLowerCase(),s,i);case 6:null===e.sent&&a.props.user.showMsg("Unauthorized"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),a.props.user.showError(e.t0);case 13:a.setState({disabled:!1});case 14:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){a.setState(Object(C.a)({},e.target.name,e.target.value))},a.handleClickReset=Object(ye.a)(we.a.mark(function e(){var t;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=a.state.username)){e.next=11;break}return e.prev=2,e.next=5,a.props.user.reset(t.trim().toLowerCase());case 5:a.props.user.showMsg("Mail sended."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),a.props.user.showError(e.t0);case 11:case"end":return e.stop()}},e,null,[[2,8]])})),a.state={username:"",password:"",token:"",disabled:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.user,n=e.translate,r=this.state,s=r.username,i=r.password,c=r.disabled,l=r.oAuth,u=r.token,p=(this.props.location.state||{from:{pathname:na.home}}).from;return l?null:a.user?o.a.createElement(f.a,{to:p}):o.a.createElement(me.a,{container:!0,component:"main",className:t.root},o.a.createElement(T.a,null),o.a.createElement(me.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),o.a.createElement(me.a,{item:!0,xs:12,sm:8,md:5,component:be.a,elevation:6,square:!0},o.a.createElement("div",{className:t.paper},o.a.createElement(ea.a,{className:t.avatar,src:"/img/logo.png"}),o.a.createElement(ca,{fullWidth:!0,disabled:c,title:n("githubSignIn")}),o.a.createElement(oa,{fullWidth:!0,disabled:c,title:n("googleSignIn")}),o.a.createElement(pa,{fullWidth:!0,disabled:c,title:n("stravaSignIn")}),o.a.createElement(H.a,{variant:"body1"},n("useAccount")),o.a.createElement("form",{className:t.form,onSubmit:this.handleSubmit},o.a.createElement(Oe.a,{margin:"normal",required:!0,fullWidth:!0},o.a.createElement(De.a,{htmlFor:"username"},n("username")),o.a.createElement(Ce.a,{id:"username",name:"username",autoComplete:"username",autoFocus:!0,value:s,onChange:this.handleChange})),o.a.createElement(Oe.a,{margin:"normal",required:!0,fullWidth:!0},o.a.createElement(De.a,{htmlFor:"password"},n("password")),o.a.createElement(Ce.a,{name:"password",type:"password",id:"password",autoComplete:"current-password",value:i,onChange:this.handleChange})),na["2fa"]&&o.a.createElement(Oe.a,{margin:"normal",fullWidth:!0},o.a.createElement(De.a,{htmlFor:"password"},n("token")),o.a.createElement(Ce.a,{name:"token",id:"token",value:u,onChange:this.handleChange})),o.a.createElement(Ae.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,disabled:c},n("signIn")))),o.a.createElement(da,null)))}}]),t}(o.a.Component),fa=k(E()(function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(/img/header.jpg)",backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:8*e.spacing.unit,marginBottom:4*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing.unit,width:64,height:64},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit,marginBottom:e.spacing.unit}}}),j,Ue,pe)(ha),ma={name:"",collaborators:[]},va=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||ma,a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addProject,r=t.getProjects,s=t.editProject,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,i);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i);case 10:r(),a.setState(ma),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(ye.a)(we.a.mark(function e(){var t,a,n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.user.getUsers,a=this.props.user.user,n=[{field:"_id",op:"ne",value:a._id}],e.prev=3,e.next=6,t(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),this.props.user.showError(e.t0);case 11:case"end":return e.stop()}},e,this,[[3,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.name,n=t.collaborators,r=this.props.user.users;return o.a.createElement(We,{onSubmit:this.handleSubmit,inline:!0},o.a.createElement(_e,{label:"Name",value:a,field:"name",onChange:this.handleChange,required:!0}),o.a.createElement("div",{className:e.collaborators},o.a.createElement(Re,{label:"Collaborators",value:n,field:"collaborators",onChange:this.handleChange,data:r.data,textField:"name",fullWidth:!0,multiple:!0})))}}]),t}(o.a.Component),ba=k(Object(te.withStyles)(function(e){return{collaborators:{display:"flex",flex:1}}}),Ue,j)(va),ga=a(313),wa=a.n(ga),ya=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).onDelete=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n,r,s;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,r=n.onDelete,s=n.onChange,e.next=3,r(t);case 3:s();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.onChange()}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.onClick,r=t.primaryTextField,s=t.secondaryTextField,i=t.onEdit,c=t.isDisabled,l=t.classes;return o.a.createElement(be.a,{className:l.listWrapper},o.a.createElement(Ut,{isLoading:a.isLoading}),o.a.createElement(M.a,null,a.data.map(function(t){return o.a.createElement(q.a,{key:t._id,button:!0,onClick:function(){return n(t._id)}},o.a.createElement(z.a,{primary:ie.a.get(t,r),secondary:s?ie.a.get(t,s):null}),o.a.createElement(wa.a,null,o.a.createElement(Mt,{disabled:c(t),onEdit:function(){return i(t)},onDelete:function(){return e.onDelete(t._id)}})))})))}}]),t}(o.a.Component),xa=Object(te.withStyles)(function(e){return{listWrapper:{position:"relative"}}})(ya),Ea=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleClick=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props.history.location.pathname+"/"+t,a.props.history.push(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){try{a.props.store.getProjects(a.props.user.user)}catch(t){a.props.user.showError(t)}},a.handleEdit=function(e){a.setState({x:e,isOpen:!0})},a.handleDelete=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.deleteProject,e.prev=1,e.next=4,n(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.projects;return o.a.createElement("div",{className:e.list},o.a.createElement(xa,{data:t,primaryTextField:"name",onClick:this.handleClick,onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled}),o.a.createElement(Yt,{title:"Edit project",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(ba,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),ka=k(Object(te.withStyles)(function(e){return{list:{marginTop:e.spacing.unit}}}),Ue,j,f.f)(Ea);var Oa=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return o.a.createElement(me.a,{container:!0,spacing:24},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(be.a,{className:e.classes.paper},o.a.createElement(ba,null)),o.a.createElement(ka,null)))}),ja={name:"",assignedToId:null,stateId:1},Ca=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||ja,a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addTask,r=t.refreshTasks,s=t.editTask,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i,a.props.projectId);case 10:r(),a.setState(ja),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.states,a=this.state,n=a.name,r=a.assignedToId,s=a.stateId,i=this.props.store.users;return o.a.createElement(We,{onSubmit:this.handleSubmit,inline:!0},o.a.createElement("div",{className:e.name},o.a.createElement(_e,{label:"Name",value:n,field:"name",onChange:this.handleChange,required:!0,fullWidth:!0})),o.a.createElement(Re,{label:"Assigned to",value:r,field:"assignedToId",onChange:this.handleChange,data:i.data,textField:"name"}),o.a.createElement(Re,{label:"State",value:s,field:"stateId",onChange:this.handleChange,data:t.data,required:!0,textField:"name"}))}}]),t}(o.a.Component),Sa=k(Object(te.withStyles)(function(e){return{name:{display:"flex",flex:1}}}),Ue,j)(Ca),Da=[{field:"name",disablePadding:!0,label:"Name"},{field:"_assignedTo.name",label:"Assigned to",type:"enum",data:"users",idField:"assignedToId",sortable:!1},{field:"_state.name",label:"State",type:"enum",data:"states",idField:"stateId",sortable:!1}],_a=[{label:"Name",key:"name"},{label:"Assigned to",key:"assignedTo.name"},{label:"State",key:"state.name"}],Ta=[],Ia=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(ye.a)(we.a.mark(function e(t,n,r){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getTasks(a.props.projectId,t,n,r);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onEdit=function(e){a.setState({x:e,isOpen:!0})},a.isDisabled=function(e){return a.props.user.user._id!==e.userId&&a.props.user.user._id!==e.assignedToId},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store,t=e.deleteTask,a=e.project,n=a?"".concat(a.name,"_tasks"):null;return o.a.createElement("div",null,o.a.createElement(Bt,{rows:Da,data:"tasks",onChange:this.handleChange,onDelete:t,title:"Tasks",onEdit:this.onEdit,store:this.props.store,filters:Ta,isDisabled:this.isDisabled,filename:n,headers:_a}),o.a.createElement(Yt,{title:"Edit task",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(Sa,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),Na=k(Ue,j)(Ia),Pa=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(ye.a)(we.a.mark(function e(){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.store.getProject(this.props.match.params.id);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.props.user.showError(e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return o.a.createElement(me.a,{container:!0,spacing:24},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(be.a,{className:this.props.classes.paper},o.a.createElement(Sa,{projectId:this.props.match.params.id}))),o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(Na,{projectId:this.props.match.params.id})))}}]),t}(o.a.Component),Fa=k(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),Ue)(Pa);var Ra=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,width:160}}})(function(e){return o.a.createElement(Et.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:e.isOpen,fullWidth:!0},o.a.createElement(Tt.a,{id:"simple-dialog-title"},e.title),e.children,o.a.createElement(Ot.a,null,e.onCancel&&o.a.createElement(Ae.a,{onClick:e.onCancel,color:"primary"},"Cancel"),e.onConfirm&&o.a.createElement(Ae.a,{onClick:e.onConfirm,color:"primary",autoFocus:!0},"OK")))}),La=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.defaultValue,n=e.tooltip,r=e.onClick,s=e.className,i=e.placement;return o.a.createElement(ct.a,{title:n,"aria-label":n,placement:i},o.a.createElement(ea.a,{style:{textTransform:"uppercase"},alt:a,src:t?"data:image/jpeg;base64,"+t:null,onClick:r,className:s},n[0]))}}]),t}(o.a.Component),Aa=Object(te.withStyles)(function(e){return{}})(La),Ma=function(e){return{col:{display:"flex",flex:1,flexDirection:"column",marginBottom:e.spacing.unit},row:{display:"flex",flexWrap:"wrap",flexDirection:"row"},center:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},paper:{padding:e.spacing.unit},flex:{display:"flex"},grow:{display:"flex",flex:1}}},Wa=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).resize=function(e,t){return new Promise(function(n){var r=new Image,s=a.canvasRef.current;r.onload=function(){r.height>t&&(r.width*=t/r.height,r.height=t);var e=s.getContext("2d");e.clearRect(0,0,s.width,s.height),s.width=r.width,s.height=r.height,e.drawImage(r,0,0,r.width,r.height);var a=s.toDataURL("image/jpeg");n(a)},r.src=e})},a.onChange=function(e){e.preventDefault();var t=new FileReader;t.onloadend=Object(ye.a)(we.a.mark(function e(){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.resize(t.result,320);case 2:n=(n=e.sent).split(",").pop(),a.props.onChange(a.props.field,n);case 5:case"end":return e.stop()}},e)})),t.readAsDataURL(e.target.files[0])},a.onClick=function(){a.props.disabled||a.inputRef.current.click()},a.inputRef=o.a.createRef(),a.canvasRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.value,n=e.tooltip,r=e.disabled;return o.a.createElement("div",{className:t.center,style:{cursor:r?"default":"pointer"}},o.a.createElement(Aa,{className:t.bigAvatar,value:a,onClick:this.onClick,tooltip:n,placement:"right"}),o.a.createElement("input",{ref:this.inputRef,style:{display:"none"},type:"file",accept:"image/jpeg",onChange:this.onChange}),o.a.createElement("canvas",{style:{display:"none"},ref:this.canvasRef}))}}]),t}(o.a.Component),qa=Object(te.withStyles)(function(e){return Object(re.a)({},Ma(e),{bigAvatar:{margin:e.spacing.unit,width:80,height:80}})})(Wa),Ua=a(314),za=a.n(Ua),Va=a(315),Ba=a.n(Va);var Ka=Object(te.withStyles)(function(e){return{formControl:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit}}})(function(e){var t=e.classes;return o.a.createElement(za.a,{className:t.formControl,control:o.a.createElement(Ba.a,{checked:e.value,onChange:function(t){return e.onChange(e.field,t.target.checked)},value:e.field,disabled:e.disabled}),label:e.label})}),Ya={password:"",repeatedPassword:"",name:"",username:"",email:"",otp:!1,avatar:null},Ga=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=Object(re.a)({},Ya,a.props.user.user,{isOpenSecretDialog:!1,avatarChanged:!1}),a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleChangeAvatar=function(e,t){var n;a.setState((n={},Object(C.a)(n,e,t),Object(C.a)(n,"avatarChanged",!0),n))},a.generateSecret=Object(ye.a)(we.a.mark(function e(){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.user.generateSecret();case 3:a.handleOpenSecretDialog(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])})),a.handleOpenSecretDialog=function(){a.setState({isOpenSecretDialog:!0})},a.handleCloseSecretDialog=function(){a.setState({isOpenSecretDialog:!1})},a.handleSubmit=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i,c,l,o,u;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.password,r=t.repeatedPassword,s=t.name,i=t.username,c=t.email,l=t.otp,o=t.avatar,u=t.avatarChanged,n===r){e.next=4;break}return a.props.user.showMsg("Passwords do not match."),e.abrupt("return");case 4:return e.prev=4,e.next=7,a.props.user.updateUser(a.state._id,{name:s,username:i,email:c,password:n,otp:l,avatar:u?o:null});case 7:a.setState(Object(re.a)({},a.props.user.user)),a.props.user.showMsg("Ok."),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),a.props.user.showError(e.t0);case 14:case"end":return e.stop()}},e,null,[[4,11]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.password,s=n.repeatedPassword,i=n.username,c=n.name,l=n.email,u=n.otp,p=n.avatar;return o.a.createElement(o.a.Fragment,null,o.a.createElement(We,{onSubmit:this.handleSubmit,disabled:a},o.a.createElement(qa,{field:"avatar",onChange:this.handleChangeAvatar,value:p,disabled:a,tooltip:c||""}),o.a.createElement(_e,{value:c,field:"name",onChange:this.handleChange,required:!0,disabled:a}),o.a.createElement(_e,{value:l,field:"email",onChange:this.handleChange,disabled:a}),o.a.createElement(_e,{value:i,field:"username",onChange:this.handleChange,required:!0,disabled:!0}),o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(_e,{value:r,field:"password",type:"new-password",onChange:this.handleChange,disabled:a})),o.a.createElement("div",{className:t.col},o.a.createElement(_e,{value:s,field:"repeatedPassword",type:"password",onChange:this.handleChange,disabled:a}))),na["2fa"]&&o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement("div",null,o.a.createElement(Ka,{value:u,field:"otp",onChange:this.handleChange,disabled:a}),o.a.createElement(Ae.a,{color:"primary",disabled:a||!this.state.otp,onClick:this.generateSecret},this.props.translate("generateSecret")))))),o.a.createElement(Ra,{title:this.props.translate("secret"),isOpen:this.state.isOpenSecretDialog,onConfirm:this.handleCloseSecretDialog},o.a.createElement("div",{className:t.center},this.props.user.secret&&o.a.createElement("img",{src:"data:image/jpeg;base64,"+this.props.user.secret.qrCode,alt:"secret",width:320,height:320}))))}}]),t}(o.a.Component),Ha=k(Object(te.withStyles)(function(e){return Object(re.a)({},Ma(e),{heading:{marginLeft:e.spacing.unit},detailHeading:{marginLeft:e.spacing.unit,marginTop:3*e.spacing.unit},actions:{float:"right",margin:e.spacing.unit}})}),Ue,j,pe)(Ga),Za={user:1,store:2,mail:4,file:8,report:16,tags:1024,tasks:2048,events:4096,enums:4096,activities:2};var Ja=k(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit},heading:{marginLeft:e.spacing.unit},connected:{padding:e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"flex-start"}}}),j,pe)(function(e){var t=e.user,a=t.user,n=!(0,t.hasPermission)(Za.user),r=e.translate("connect");return o.a.createElement(me.a,{container:!0,spacing:16},o.a.createElement(me.a,{item:!0,xs:12,sm:8},o.a.createElement(be.a,{className:e.classes.paper},o.a.createElement(Ha,{disabled:n}))),o.a.createElement(me.a,{item:!0,xs:12,sm:4},o.a.createElement(be.a,{className:e.classes.connected},o.a.createElement(H.a,{variant:"h6",className:e.classes.heading},e.translate("connected")),o.a.createElement(ca,{disabled:n||a.github,title:e.user.user.github?e.user.user.github.name:r}),o.a.createElement(oa,{disabled:n||a.google,title:e.user.user.google?e.user.user.google.name:r}),o.a.createElement("div",null,o.a.createElement(pa,{disabled:n,title:e.user.user.strava?e.translate("sync"):r}),e.user.user.strava&&e.user.user.strava.synced&&o.a.createElement("span",null," (",e.translate("lastSync")," ",new Date(e.user.user.strava.synced).toLocaleDateString(e.locale),") ")))))}),Xa=a(87),$a=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.stats,t=this.props.theme;return o.a.createElement(be.a,{className:this.props.classes.paper},o.a.createElement(Xa.b,{width:800,height:300,data:e.data},o.a.createElement(Xa.c,{strokeDasharray:"3 3"}),o.a.createElement(Xa.e,{dataKey:"name"}),o.a.createElement(Xa.f,null),o.a.createElement(Xa.d,null),o.a.createElement(Xa.a,{dataKey:"val",fill:t.palette.primary.main})),o.a.createElement(H.a,{variant:"body2",color:"textPrimary",component:"p",className:this.props.classes.heading},"Total: ",e.sum))}}]),t}(l.PureComponent),Qa=k(Ue,Object(te.withStyles)(function(e){return{paper:{width:"100%",padding:e.spacing.unit,overflowX:"auto",margin:"auto"},heading:{marginLeft:e.spacing.unit}}}),Object(te.withTheme)())($a);var en,tn,an,nn=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return o.a.createElement(me.a,{container:!0,spacing:16},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(Qa,null)),o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(Xt,{filters:[],defaultFilters:{period:4}})))}),rn=function(e){function t(e){var a;Object(n.a)(this,t),a=Object(s.a)(this,Object(i.a)(t).call(this,e));var r=new URLSearchParams(a.props.location.search);return tn=r.get("provider"),en=r.get("code"),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(ye.a)(we.a.mark(function e(){var t;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!tn||an){e.next=22;break}if(an=!0,t=this.props.user,e.prev=3,!t.user){e.next=10;break}return e.next=7,t.updateOauth(tn,en);case 7:this.props.history.replace("/account"),e.next=15;break;case 10:return e.next=12,t.oAuth(tn,en);case 12:if(e.sent){e.next=14;break}t.showMsg("Unauthorized");case 14:this.props.history.replace(na.home);case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),this.props.user.showError(e.t0),this.props.history.replace("/login");case 21:an=!1;case 22:case"end":return e.stop()}},e,this,[[3,17]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.translate;return tn?o.a.createElement("main",{className:t.main},o.a.createElement(T.a,null),o.a.createElement(be.a,{className:t.paper},o.a.createElement(ea.a,{className:t.avatar,src:"/img/logo.png"}),o.a.createElement("div",{className:t.loader},o.a.createElement(H.a,{component:"h1",variant:"h5"},a("loading"))))):o.a.createElement(f.a,{to:{pathname:na.home}})}}]),t}(o.a.Component),sn=k(E()(function(e){return{main:Object(C.a)({width:"100%",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,width:64,height:64},loader:{marginTop:e.spacing.unit}}}),j,Ue,pe)(rn),cn={name:"",address:"",ico:"",dic:"",icdph:"",rate:0,reportId:"",activity:""},ln=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||cn,a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addClient,r=t.getClients,s=t.editClient,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,i);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i);case 10:r(),a.props.onSubmit&&a.props.onSubmit(),a.setState(cn),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.name,s=n.address,i=n.ico,c=n.dic,l=n.icdph,u=n.rate,p=n.reportId,d=n.activity;return o.a.createElement(We,{onSubmit:this.handleSubmit,disabled:a},o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(_e,{label:"Name",value:r,field:"name",onChange:this.handleChange,required:!0,disabled:a}))),o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(_e,{className:t.col,label:"Address",value:s,field:"address",onChange:this.handleChange,required:!0,disabled:a}))),o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(_e,{label:"I\u010cO",value:i,field:"ico",onChange:this.handleChange,required:!0,disabled:a})),o.a.createElement("div",{className:t.col},o.a.createElement(_e,{className:t.col,label:"DI\u010c",value:c,field:"dic",onChange:this.handleChange,required:!0,disabled:a})),o.a.createElement("div",{className:t.col},o.a.createElement(_e,{className:t.col,label:"I\u010c DPH",value:l,field:"icdph",onChange:this.handleChange,required:!0,disabled:a}))),o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(_e,{label:"Activity",value:d,field:"activity",onChange:this.handleChange,required:!0,disabled:a})),o.a.createElement("div",{className:t.col},o.a.createElement(Te,{label:"Rate",value:u,field:"rate",onChange:this.handleChange,min:0,step:.5,required:!0})),o.a.createElement("div",{className:t.col},o.a.createElement(_e,{className:t.col,label:"ReportId",value:p,field:"reportId",onChange:this.handleChange,required:!0,disabled:a}))))}}]),t}(o.a.Component),on=k(Object(te.withStyles)(function(e){return Object(re.a)({},Ma(e))}),Ue,j)(ln),un=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleClick=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props.history.location.pathname+"/"+t,a.props.history.push(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){try{a.props.store.getClients()}catch(t){a.props.user.showError(t)}},a.handleEdit=function(e){a.setState({x:e,isOpen:!0})},a.handleDelete=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.deleteClient,e.prev=1,e.next=4,n(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.clients;return o.a.createElement("div",{className:e.list},o.a.createElement(xa,{data:t,primaryTextField:"name",onClick:this.handleClick,onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled}),o.a.createElement(Yt,{title:"Edit client",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(on,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),pn=k(Object(te.withStyles)(function(e){return{list:{marginTop:e.spacing.unit}}}),Ue,j,f.f)(un);var dn=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return o.a.createElement(me.a,{container:!0,spacing:24},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(be.a,{className:e.classes.paper},o.a.createElement(on,null)),o.a.createElement(pn,null)))});var hn=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:160}}})(function(e){var t=e.classes;return o.a.createElement(xe.b,{className:t.formControl,keyboard:!0,ampm:!1,label:e.label,format:"MM/DD/YYYY HH:mm",clearable:!e.required,mask:function(e){return e?[/\d/,/\d/,"/",/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/]:[]},value:e.value||null,onChange:function(t){return e.onChange(e.field,t?t.toDate():null)},disableOpenOnEnter:!0,animateYearScrolling:!1,style:{flex:1,display:"flex"},disabled:e.disabled})}),fn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).getInitState=function(e){var t=e.date||Pt()().add(1,"days").toDate();return{start:t,end:t,name:"",eventTypeId:null}},a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleChangeStart=function(e,t){t.getTime()>a.state.end.getTime()?a.setState({start:t,end:t}):a.setState({start:t})},a.handleChangeEnd=function(e,t){t.getTime()<a.state.start.getTime()?a.setState({start:t,end:t}):a.setState({end:t})},a.handleSubmit=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addEvent,r=t.refreshEvents,s=t.editEvent,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,i);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i);case 10:r(),a.setState(a.getInitState(a.props)),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a.state=e.data||a.getInitState(e),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.name,s=n.eventTypeId,i=n.start,c=n.end,l=this.props.store.filteredEnums;return o.a.createElement(We,{onSubmit:this.handleSubmit,inline:!0,disabled:a},o.a.createElement("div",{className:t.nameTextInput},o.a.createElement(_e,{label:"Name",value:r,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:a})),o.a.createElement(Re,{label:"Type",value:s,field:"eventTypeId",onChange:this.handleChange,data:l.data,textField:"name",disabled:a}),o.a.createElement("div",{className:t.nameTextInput},o.a.createElement(hn,{label:"Start",value:i,field:"start",onChange:this.handleChangeStart,required:!0,disabled:a}),o.a.createElement(hn,{label:"End",value:c,field:"end",onChange:this.handleChangeEnd,required:!0,disabled:a})))}}]),t}(o.a.Component),mn=k(Object(te.withStyles)(function(e){return{nameTextInput:{display:"flex",flex:1}}}),Ue,j)(fn),vn=[{field:"name",disablePadding:!0,label:"Name"},{field:"_eventType.name",label:"Type",type:"enum",data:"filteredEnums",idField:"eventTypeId"},{field:"start",type:"datetime",label:"Start",filterable:!1},{field:"end",type:"datetime",label:"End",filterable:!1},{field:"_user.name",label:"User",type:"enum",data:"users",idField:"userId"}],bn=[{label:"Name",key:"name"},{label:"Type",key:"_eventType.name"},{label:"Start",key:"start"},{label:"End",key:"end"},{label:"User",key:"_user.name"}],gn=[{label:"Period",field:"period",data:[{_id:1,name:"today",filters:[{field:"start",op:"lte",value:Pt()().endOf("day").toDate()},{field:"start",op:"gte",value:Pt()().startOf("day").toDate()}]},{_id:2,name:"this week",filters:[{field:"start",op:"lte",value:Pt()().endOf("week").toDate()},{field:"start",op:"gte",value:Pt()().startOf("week").toDate()}]},{_id:3,name:"last week",filters:[{field:"start",op:"lte",value:Pt()().subtract(1,"weeks").endOf("week").toDate()},{field:"start",op:"gte",value:Pt()().subtract(1,"weeks").startOf("week").toDate()}]},{_id:4,name:"this month",filters:[{field:"start",op:"lte",value:Pt()().endOf("month").toDate()},{field:"start",op:"gte",value:Pt()().startOf("month").toDate()}]},{_id:5,name:"last month",filters:[{field:"start",op:"lte",value:Pt()().subtract(1,"month").endOf("month").toDate()},{field:"start",op:"gte",value:Pt()().subtract(1,"month").startOf("month").toDate()}]}]}],wn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChangeClient=function(e,t){a.setState({clientId:t})},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(ye.a)(we.a.mark(function e(t,n){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getEvents(t,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.onEdit=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({x:t,isOpen:!0});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a.state={x:null,isOpen:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.deleteEvent;return o.a.createElement("div",null,o.a.createElement(Bt,{rows:vn,data:"events",onChange:this.handleChange,sortable:!1,onDelete:e,title:"Events",onEdit:this.onEdit,store:this.props.store,filters:gn,isDisabled:this.isDisabled,headers:bn}),o.a.createElement(Yt,{title:"Edit event",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(mn,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),yn=k(Ue,j)(wn);var xn=k(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),j)(function(e){return o.a.createElement(me.a,{container:!0,spacing:16},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(be.a,{className:e.classes.paper},o.a.createElement(mn,null))),o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(yn,null)))}),En={name:"",enumTypeId:1,disabled:!1,key:0},kn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(ye.a)(we.a.mark(function e(){var t,n,r,s;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addEnum,r=t.refreshEnums,s=t.editEnum,e.prev=1,!a.state._id){e.next=7;break}return e.next=5,s(a.state);case 5:e.next=9;break;case 7:return e.next=9,n(a.state);case 9:r(),a.setState(En),a.props.onSubmit&&a.props.onSubmit(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),a.props.user.showError(e.t0);case 17:case"end":return e.stop()}},e,null,[[1,14]])})),a.state=e.data||En,a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.name,s=n.enumTypeId,i=n.key,c=this.props.store.enumTypes;return o.a.createElement(We,{onSubmit:this.handleSubmit,inline:!0,disabled:a},o.a.createElement("div",{className:t.nameTextInput},o.a.createElement(_e,{label:"Name",value:r,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:a})),o.a.createElement(Re,{label:"Type",value:s,field:"enumTypeId",onChange:this.handleChange,data:c.data,textField:"name",required:!0,disabled:a}),o.a.createElement(Te,{label:"Key",value:i,field:"key",onChange:this.handleChange,min:0,step:1,required:!0}),o.a.createElement(Ka,{label:"",value:this.state.disabled,field:"disabled",onChange:this.handleChange}))}}]),t}(o.a.Component),On=k(Object(te.withStyles)(function(e){return{nameTextInput:{display:"flex",flex:1}}}),Ue,j)(kn),jn=[{field:"name",disablePadding:!0,label:"Name"},{field:"_enumType.name",label:"Type",type:"enum",data:"enumTypes",idField:"enumTypeId",sortable:!1},{field:"key",label:"Key",type:"num"},{field:"disabled",label:"Disabled",type:"bool"}],Cn=[{label:"Name",key:"name"},{label:"Type",key:"enumType.name"}],Sn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChangeClient=function(e,t){a.setState({clientId:t})},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(ye.a)(we.a.mark(function e(t,n,r){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getEnums(t,r,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onEdit=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({x:t,isOpen:!0});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return!1},a.state={x:null,isOpen:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.deleteEnum;return o.a.createElement("div",null,o.a.createElement(Bt,{rows:jn,data:"enums",onChange:this.handleChange,onDelete:e,title:"Enums",onEdit:this.onEdit,store:this.props.store,filters:[],isDisabled:this.isDisabled,headers:Cn}),o.a.createElement(Yt,{title:"Edit Enum",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(On,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),Dn=k(Ue,j)(Sn);var _n=k(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),j)(function(e){return o.a.createElement(me.a,{container:!0,spacing:16},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(be.a,{className:e.classes.paper},o.a.createElement(On,null))),o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(Dn,null)))}),Tn=a(324),In=a(113),Nn=a(325),Pn=a(326),Fn=(a(728),a(729),a(730),a(731),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).calendarComponentRef=o.a.createRef(),a.state={defaultView:"dayGridMonth",defaultDate:new Date},a.eventDataTransform=function(e){return e.id=e._id,e.title=e[a.props.textField],e.color=a.props.getColor(e),e},a.handleDateClick=function(e){a.props.onSelect(null,e.date)},a.handleEventClick=function(e){var t=a.props.data.data.find(function(t){return t._id===e.event.id});a.props.onSelect(t,e.date)},a.handleViewDisplay=function(e){var t=[{field:"start",op:"gte",value:e.view.activeStart},{field:"end",op:"lte",value:e.view.activeEnd}];a.props.onChange(t,{limit:200,skip:0},null),a.setState({defaultView:e.view.type,defaultDate:e.view.activeStart})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.defaultDate,a=e.defaultView;return o.a.createElement("div",{className:"Calendar"},o.a.createElement(Tn.a,{defaultView:a,defaultDate:t,header:{left:"today, prev, next, title",right:"dayGridMonth, timeGridWeek, timeGridDay"},plugins:[In.d,Nn.a,Pn.a],ref:this.calendarComponentRef,weekends:!0,events:this.props.data.data,dateClick:this.handleDateClick,eventClick:this.handleEventClick,eventDataTransform:this.eventDataTransform,datesRender:this.handleViewDisplay,eventColor:this.props.theme.palette.primary.main}))}}]),t}(o.a.Component)),Rn=Object(te.withTheme)()(Fn),Ln=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).getColor=function(e){var t=a.props.theme;if(!e._eventType)return t.palette.secondary.main;switch(e._eventType.key){case 1:return t.palette.primary.main;default:return t.palette.secondary.main}},a.handleSelect=function(e,t){a.setState({x:e,isOpen:!0,date:t})},a.handleClose=function(){a.setState({isOpen:!1})},a.handleChange=function(){var e=Object(ye.a)(we.a.mark(function e(t,n,r){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getEvents(t,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.state={x:null,isOpen:!1,date:null},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.events,t=this.props.user.user,a=this.state.x&&this.state.x.userId!==t._id;return o.a.createElement(me.a,{container:!0,spacing:16},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(be.a,{className:this.props.classes.paper},o.a.createElement(Rn,{onSelect:this.handleSelect,onChange:this.handleChange,textField:"name",data:e,getColor:this.getColor}),o.a.createElement(Yt,{title:"Event",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(mn,{data:this.state.x,onSubmit:this.handleClose,date:this.state.date,disabled:a})))))}}]),t}(o.a.Component),An=k(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),j,Ue,Object(te.withTheme)())(Ln),Mn=a(86),Wn=a(327),qn=a.n(Wn),Un=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).state={delay:500,legacy:!0},a.handleScan=a.handleScan.bind(Object(Mn.a)(Object(Mn.a)(a))),a.openImageDialog=a.openImageDialog.bind(Object(Mn.a)(Object(Mn.a)(a))),a.myRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"handleScan",value:function(e){if(e){var t=e.split(".");if(2===t.length)try{this.props.user.verify(t[0],t[1])}catch(a){this.props.user.showError(a)}}}},{key:"handleError",value:function(e){console.error(e)}},{key:"openImageDialog",value:function(){var e=this;this.setState({legacy:!0},function(){e.myRef.current.openImageDialog()})}},{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{className:e.row},o.a.createElement("div",{className:e.col},o.a.createElement("div",{className:e.center},o.a.createElement(qn.a,{ref:this.myRef,delay:this.state.delay,style:{height:320,width:320},onError:this.handleError,onScan:this.handleScan,legacyMode:this.state.legacy}),o.a.createElement(Ae.a,{variant:"contained",color:"primary",className:e.submit,onClick:this.openImageDialog},"Scan"))),o.a.createElement("div",{className:e.col},o.a.createElement(be.a,{className:e.paper},o.a.createElement(H.a,{variant:"h6"},"Data"),this.props.user.signature&&o.a.createElement("div",null,o.a.createElement(H.a,{variant:"body1"},this.props.user.signature.data)))))}}]),t}(l.Component),zn=k(Object(te.withStyles)(function(e){return Object(re.a)({},Ma(e))}),Ue,j)(Un),Vn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleSubmit=function(){try{a.props.user.sign(a.state.data)}catch(e){a.props.user.showError(e)}},a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.state={data:""},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{className:e.row},o.a.createElement("div",{className:e.col},o.a.createElement(be.a,{className:e.paper},o.a.createElement(We,{onSubmit:this.handleSubmit},o.a.createElement("div",{className:e.flex},o.a.createElement(_e,{label:"Data",value:this.state.data,field:"data",onChange:this.handleChange,required:!0,multiline:!0,fullWidth:!0,rows:8}))))),o.a.createElement("div",{className:e.col},o.a.createElement("div",{className:e.center},this.props.user.signature&&o.a.createElement("img",{src:"data:image/jpeg;base64,"+this.props.user.signature.qrCode,alt:"signature",width:320,height:320}))))}}]),t}(l.Component),Bn=k(Object(te.withStyles)(function(e){return Object(re.a)({},Ma(e))}),Ue,j)(Vn),Kn=a(329),Yn=a.n(Kn);var Gn=Object(te.withStyles)(function(e){return{}})(function(e){var t=e.color,a=e.onClick,n=e.tooltip,r=e.disabled,s=e.className;return o.a.createElement(ct.a,{title:n},o.a.createElement(g.a,{color:t,onClick:a,"aria-label":n,disabled:r,className:s},e.children))}),Hn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).onChange=function(e){e.preventDefault();var t=e.target.files[0];a.props.onChange(a.props.field,t)},a.onClick=function(){a.props.disabled||a.inputRef.current.click()},a.inputRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.value,n=e.disabled,r=e.mimeType;return o.a.createElement("div",null,o.a.createElement(Gn,{className:t.button,tooltip:"Attach file",color:a?"primary":"default",onClick:this.onClick,disabled:n},o.a.createElement(Yn.a,null)),o.a.createElement("input",{ref:this.inputRef,style:{display:"none"},type:"file",accept:r,onChange:this.onChange}))}}]),t}(o.a.Component),Zn=Object(te.withStyles)(function(e){return Object(re.a)({},Ma(e),{button:{marginTop:e.spacing.unit,marginBottom:e.spacing.unit}})})(Hn),Jn={name:"",likes:[],likesCnt:0,typesId:[],unavailable:!1,_img:null},Xn=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||Jn,a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i,c;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addTag,r=t.getTags,s=t.editTag,i=t.tags,c=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,c);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,c);case 10:r(i.filters),a.setState(Jn),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.name,n=t.typesId,r=t.disabled,s=t._img,i=this.props.store.filteredEnums;return o.a.createElement(We,{onSubmit:this.handleSubmit,inline:!0},o.a.createElement(_e,{label:"Name",value:a,field:"name",onChange:this.handleChange,required:!0}),o.a.createElement("div",{className:e.collaborators},o.a.createElement(Re,{label:"Types",value:n,field:"typesId",onChange:this.handleChange,data:i.data,textField:"name",fullWidth:!0,multiple:!0})),o.a.createElement(Zn,{mimeType:"image/jpeg",value:s,field:"_img",onChange:this.handleChange,disabled:void 0!==this.state._id}),o.a.createElement(Ka,{label:"",value:r,field:"disabled",onChange:this.handleChange}))}}]),t}(o.a.Component),$n=k(Object(te.withStyles)(function(e){return{collaborators:{display:"flex",flex:1}}}),Ue,j)(Xn),Qn=a(337),er=a.n(Qn),tr=a(338),ar=a.n(tr),nr=a(331),rr=a.n(nr),sr=a(332),ir=a.n(sr),cr=a(333),lr=a.n(cr),or=a(202),ur=a.n(or),pr=a(334),dr=a.n(pr),hr=a(336),fr=a.n(hr),mr=a(193),vr=a.n(mr),br=a(335),gr=a.n(br),wr=a(330),yr=a.n(wr),xr=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={imgViz:!1,img:null},a.state={expanded:!1},a.handleExpandClick=function(){a.setState(function(e){return{expanded:!e.expanded}})},a.onViz=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n,r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onViz();case 2:n=e.sent,a.setState({imgViz:!0}),n&&((r=new FileReader).onloadend=function(){a.setState({img:r.result})},r.readAsDataURL(n));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.actions,n=e.children,r=e.cardActions,s=e.primary,i=e.secondary,c=e.avatar,l=e.defaultAvatar,u=e.tooltip,p=e.content;return o.a.createElement(yr.a,{partialVisibility:!0,onChange:this.onViz},o.a.createElement(rr.a,{className:t.card},o.a.createElement(ir.a,{avatar:o.a.createElement(Aa,{className:t.bigAvatar,defaultValue:l,value:c,tooltip:u}),action:a,title:s,subheader:i}),o.a.createElement(lr.a,{className:t.media,image:this.state.img||"https://next.material-ui.com/static/images/cards/paella.jpg",title:"media",style:{opacity:this.state.imgViz?1:.25,transition:"opacity 500ms linear"}}),o.a.createElement(ur.a,null,p),o.a.createElement(dr.a,{className:t.actions,disableActionSpacing:!0},r,n&&o.a.createElement(g.a,{className:ut()(t.expand,Object(C.a)({},t.expandOpen,this.state.expanded)),onClick:this.handleExpandClick,"aria-expanded":this.state.expanded,"aria-label":"Show more"},o.a.createElement(gr.a,null))),o.a.createElement(fr.a,{in:this.state.expanded,timeout:"auto",unmountOnExit:!0},o.a.createElement(ur.a,null,n))))}}]),t}(o.a.Component),Er=Object(te.withStyles)(function(e){return{card:{margin:e.spacing.unit,width:"100%",maxWidth:480},media:{height:0,paddingTop:"56.25%"},actions:{display:"flex"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:vr.a[500]}}})(xr),kr=Object(te.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(wt.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 auto"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}})(function(e){var t=e.classes,a=e.onFilter,n=e.title,r=e.isFilterSet,s=e.actions,i=e.onRefresh;return o.a.createElement(Y.a,{className:t.root},o.a.createElement("div",{className:t.title},o.a.createElement(H.a,{variant:"h6",id:"tableTitle"},n)),o.a.createElement("div",{className:t.spacer}),o.a.createElement("div",{className:t.actions},s,o.a.createElement(ct.a,{title:"Filter list"},o.a.createElement(g.a,{"aria-label":"Filter list",color:r?"primary":"default",onClick:a},o.a.createElement(vt.a,null))),o.a.createElement(ct.a,{title:"Refresh list"},o.a.createElement(g.a,{"aria-label":"Refresh list",onClick:i},o.a.createElement(gt.a,null)))))}),Or=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleOpenFilter=function(){a.setState({isOpenFilter:!0})},a.handleCloseFilter=function(){a.setState({isOpenFilter:!1})},a.onDelete=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n,r,s;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,r=n.onDelete,s=n.onChange,e.next=3,r(t);case 3:s(a.state.filters);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleConfirmFilter=function(e){var t=Ft(a.props.rows,a.props.filters,e);a.props.onChange(t),a.setState({filters:t,isOpenFilter:!1})},a.handleRefresh=function(){a.props.onChange(a.state.filters)},a.state={isOpenFilter:!1,filters:Ft(e.rows,e.filters,e.defaultFilters)},a.exportRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.onChange(this.state.filters)}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.primaryTextField,r=t.secondaryTextField,s=t.onEdit,i=t.isDisabled,c=t.classes,l=t.onLike,u=t.isLiked,p=t.avatarField,d=t.defaultAvatarField,h=t.tooltipField,f=t.onMsg,m=t.cntField,v=t.theme,b=t.onViz;return o.a.createElement(be.a,{className:c.listWrapper},o.a.createElement(kr,{onFilter:this.handleOpenFilter,isFilterSet:this.state.filters.length>0,actions:this.props.actions,title:this.props.title,onRefresh:this.handleRefresh}),o.a.createElement(Ut,{isLoading:a.isLoading}),o.a.createElement("div",{className:c.list},a.data.map(function(t){return o.a.createElement(Er,{content:e.props.getContent(t),primary:ie.a.get(t,n),secondary:ie.a.get(t,r),avatar:ie.a.get(t,p),defaultAvatar:ie.a.get(t,d),tooltip:ie.a.get(t,h),onLike:function(){return l(t)},onViz:function(){return b(t)},actions:o.a.createElement(Mt,{disabled:i(t),onEdit:function(){return s(t)},onDelete:function(){return e.onDelete(t)}}),cardActions:o.a.createElement(o.a.Fragment,null,o.a.createElement(ct.a,{title:"Like"},o.a.createElement(Ae.a,{onClick:function(){return l(t._id)},style:{color:u(t)?v.palette.primary.main:"rgba(0, 0, 0, 0.54)"}},o.a.createElement(er.a,null),ie.a.get(t,m))),o.a.createElement(Gn,{tooltip:"Send message",onClick:function(){return f(t)}},o.a.createElement(ar.a,null)))})})),o.a.createElement(Rt,{isOpen:this.state.isOpenFilter,onClose:this.handleCloseFilter,onConfirm:this.handleConfirmFilter,store:this.props.store,rows:this.props.rows,filters:this.props.filters,defaultState:this.props.defaultFilters}))}}]),t}(o.a.Component),jr=Object(te.withTheme)()(Object(te.withStyles)(function(e){return{listWrapper:{position:"relative"},list:{display:"flex",flexWrap:"wrap"}}})(Or)),Cr=[{field:"user.name",label:"Tag",type:"enum",data:"filteredEnums",idField:"typesId"}],Sr=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getTags(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),a.props.user.showError(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),a.handleEdit=function(e){a.setState({x:e,isOpen:!0})},a.handleDelete=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.deleteTag,e.prev=1,e.next=4,n(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a.handleLike=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n,r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.likeTag,r=a.props.user.user,e.prev=2,e.next=5,n(t,r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),a.props.user.showError(e.t0);case 10:case"end":return e.stop()}},e,null,[[2,7]])}));return function(t){return e.apply(this,arguments)}}(),a.handleMsg=function(e){var t=a.props.user.user;window.open("mailto:".concat(e._user.email,"?subject=APP: ").concat(e.name,"&body=%0D%0A").concat(t.name),"_self")},a.isLiked=function(e){return e.likes.includes(a.props.user.user._id)},a.getContent=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(H.a,{variant:"subtitle1",color:"textPrimary"},e.name),o.a.createElement(H.a,{variant:"body2",color:"textSecondary",component:"p"},e._tagTypesStr||"\u017eiadne"))},a.getFilters=function(){return[{label:"Likes",field:"likes",data:[{_id:1,name:"Me",filters:[{field:"likes",value:a.props.user.user._id}]}]}]},a.handleViz=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.imgId){e.next=6;break}return e.next=3,a.props.store.getFile(t.imgId);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=null;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.tags;return o.a.createElement("div",{className:e.list},o.a.createElement(jr,{data:t,getContent:this.getContent,primaryTextField:"_user.name",secondaryTextField:"_dateStr",avatarField:"_user.avatar",tooltipField:"_user.name",cntField:"likesCnt",onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled,onLike:this.handleLike,isLiked:this.isLiked,filters:this.getFilters(),onViz:this.handleViz,rows:Cr,store:this.props.store,title:"Tags",onMsg:this.handleMsg}),o.a.createElement(Yt,{title:"Edit tag",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement($n,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),Dr=k(Object(te.withStyles)(function(e){return{list:{marginTop:e.spacing.unit}}}),Ue,j,f.f)(Sr);var _r,Tr,Ir,Nr,Pr,Fr,Rr,Lr,Ar=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return o.a.createElement(me.a,{container:!0,spacing:24},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement(be.a,{className:e.classes.paper},o.a.createElement($n,null)),o.a.createElement(Dr,null)))}),Mr=function(e){return[{_id:1,name:e("totalDistance")},{_id:2,name:e("totalElevation")},{_id:3,name:e("totalTime")},{_id:8,name:e("totalKudos")},{_id:4,name:e("maxDistance")},{_id:5,name:e("maxElevation")},{_id:6,name:e("maxTime")},{_id:9,name:e("maxKudos")},{_id:7,name:e("count")}]},Wr=function(e){return[{_id:1,name:e("thisWeek")},{_id:2,name:e("lastWeek")},{_id:3,name:e("thisMonth")},{_id:4,name:e("lastMonth")},{_id:5,name:e("thisYear")},{_id:6,name:e("myMonths")},{_id:7,name:e("myYears")}]},qr=function(e){return[{_id:0,name:e("all")},{_id:1,name:e("ride")},{_id:2,name:e("run")},{_id:3,name:e("walk")},{_id:4,name:e("hike")}]},Ur=function(e){switch(e){case 6:return"month";case 7:return"year";default:return"userId"}},zr=function(e){switch(e){case 1:case 2:case 3:case 8:return"sum";case 4:case 5:case 6:case 9:return"max";case 7:default:return"count"}},Vr=function(e){switch(e){case 1:case 4:return"dis";case 2:case 5:return"total_elevation_gain";case 3:case 6:return"moving_time";case 8:case 9:return"kudos_count";default:return"_id"}},Br=function(e,t){return{field:Ur(e),op:zr(t),opField:Vr(t)}},Kr=function(e){switch(e){case 1:return[{field:"type",value:"Ride"}];case 2:return[{field:"type",value:"Run"}];case 3:return[{field:"type",value:"Walk"}];case 4:return[{field:"type",value:"Hike"}];case 0:default:return[]}},Yr=function(e,t){switch(e){case 1:return[{field:"start_date",op:"lte",value:Pt()().endOf("week").toDate()},{field:"start_date",op:"gte",value:Pt()().startOf("week").toDate()}];case 2:return[{field:"start_date",op:"lte",value:Pt()().subtract(1,"weeks").endOf("week").toDate()},{field:"start_date",op:"gte",value:Pt()().subtract(1,"weeks").startOf("week").toDate()}];case 3:return[{field:"start_date",op:"lte",value:Pt()().endOf("month").toDate()},{field:"start_date",op:"gte",value:Pt()().startOf("month").toDate()}];case 4:return[{field:"start_date",op:"lte",value:Pt()().subtract(1,"month").endOf("month").toDate()},{field:"start_date",op:"gte",value:Pt()().subtract(1,"month").startOf("month").toDate()}];case 5:return[{field:"start_date",op:"lte",value:Pt()().endOf("year").toDate()},{field:"start_date",op:"gte",value:Pt()().startOf("year").toDate()}];case 6:case 7:return[{field:"userId",value:t._id}];default:return[]}},Gr=function(e){if(!e._user)return null;var t=ie.a.get(e,"_user.name");return o.a.createElement(aa.a,{color:"inherit",href:"https://www.strava.com/athletes/".concat(e._user.strava.oAuthId),target:"_blank",rel:"noopener noreferrer"},t)},Hr=function(e,t){switch(e){case 6:return{field:"_id",label:t("months"),filterable:!1,disablePadding:!0};case 7:return{field:"_id",label:t("years"),filterable:!1,disablePadding:!0};default:return{field:"_user.name",label:t("user"),filterable:!1,sortable:!1,disablePadding:!0,cell:Gr}}},Zr=function(e,t){switch(e){case 1:case 4:return{field:"val",label:t("distance"),filterable:!1};case 2:case 5:return{field:"val",label:t("elevation"),filterable:!1};case 3:case 6:return{field:"val",label:t("time"),filterable:!1};case 7:return{field:"val",label:t("count"),filterable:!1};case 8:case 9:return{field:"val",label:t("kudos"),filterable:!1};default:return{field:"val",label:t("value"),filterable:!1}}},Jr=function(e,t,a){return[Hr(e,a),Zr(t,a)]},Xr=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e,t,n){Pr=e,Tr=n,Ir=t,a.getList()},a.getList=Object(ye.a)(we.a.mark(function e(){var t;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=[].concat(Object(Ke.a)(_r),Object(Ke.a)(Pr),Object(Ke.a)(Fr),Object(Ke.a)(Lr)),e.next=4,a.props.store.getActivities(Nr,t,Ir,Tr,a.props.locale);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),a.props.user.showError(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])})),a.isDisabled=function(e){return!0},a.handleChangeType=function(e,t){a.setState(Object(C.a)({},e,t)),Fr=Kr(t),a.getList()},a.handleChangeOp=function(e,t){a.setState(Object(C.a)({},e,t)),Nr=Br(a.state.groupId,t),a.getList()},a.handleChangeGroup=function(e,t){var n=a.props.user.user;a.setState(Object(C.a)({},e,t)),_r=Yr(t,n),Nr=Br(t,a.state.opId),a.getList()},a.handleChangeSearch=function(e,t){a.setState(Object(C.a)({},e,t)),clearTimeout(Rr),Rr=setTimeout(function(){Lr=t?[{field:"name",op:"regex",value:t}]:[],a.getList()},500)};return a.state={opId:1,groupId:1,typeId:0,search:""},_r=Yr(1,e.user.user),Nr=Br(1,1),Fr=[],Lr=[],a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e,t,a=this.state,n=a.opId,r=a.groupId,s=a.typeId,i=this.props,c=i.classes,l=i.translate;return o.a.createElement("div",null,o.a.createElement(be.a,{className:ut()(c.paper,c.row)},o.a.createElement(Re,{value:s,field:"typeId",onChange:this.handleChangeType,data:qr(l),textField:"name",required:!0}),o.a.createElement(Re,{value:n,field:"opId",onChange:this.handleChangeOp,data:Mr(l),textField:"name",required:!0}),o.a.createElement(Re,{value:r,field:"groupId",onChange:this.handleChangeGroup,data:Wr(l),textField:"name",required:!0}),o.a.createElement("div",{className:c.grow}),this.props.user.user.strava&&o.a.createElement("span",{className:c.sync},o.a.createElement(pa,{title:l("sync")}))),o.a.createElement(Bt,{rows:Jr(this.state.groupId,this.state.opId,l),data:"activities",onChange:this.handleChange,title:l("activities"),store:this.props.store,filters:(e=this.props.store.getUsersInClub,t=this.props.user.user,[{field:"club",data:[{_id:1,name:"VYPADNI VON",filters:[{field:"userId",op:"in",value:function(){return e(562456)}}]},{_id:2,name:"TATRANSK\xc9 KOZY",filters:[{field:"userId",op:"in",value:function(){return e(771781)}}]},{_id:3,name:"ME",filters:[{field:"userId",value:t._id}]}]},{field:"sex",data:[{_id:1,name:"Male",filters:[{field:"sex",op:"eq",value:"M"}]},{_id:2,name:"Female",filters:[{field:"sex",op:"eq",value:"F"}]}]}]),defaultSort:{field:"val",dir:"desc"},isDisabled:this.isDisabled}),o.a.createElement(H.a,{variant:"body1",className:this.props.classes.footer},l("rideNote")))}}]),t}(o.a.Component),$r=k(Ue,j,Object(te.withStyles)(function(e){return Object(re.a)({},Ma(e),{paper:{marginBottom:e.spacing.unit},footer:{marginTop:e.spacing.unit},sync:{padding:e.spacing.unit}})}),pe)(Xr);var Qr=k(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),j)(function(e){return o.a.createElement(me.a,{container:!0,spacing:16},o.a.createElement(me.a,{item:!0,xs:12},o.a.createElement($r,null)))}),es=[{name:"records",path:"/records",component:$t,exact:!0,permission:Za.tasks},{name:"clients",path:"/clients",component:dn,exact:!0,permission:Za.report},{name:"projects",path:"/projects",component:Oa,exact:!0,permission:Za.tasks},{name:"reports",path:"/reports",component:nn,exact:!0,permission:Za.tasks},{name:"events",path:"/events",component:xn,exact:!0,permission:Za.tasks},{name:"enums",path:"/enums",component:_n,exact:!0,permission:Za.enums},{name:"calendar",path:"/calendar",component:An,exact:!0,permission:Za.events},{name:"sign",path:"/sign",component:Bn,exact:!0,permission:Za.report},{name:"verify",path:"/verify",component:zn,exact:!0,permission:Za.report},{name:"project",path:"/projects/:id",component:Fa,permission:Za.tasks},{name:"login",path:"/login",component:fa,anonymous:!0,exact:!0,hidden:!0},{name:"oauth",path:"/",component:sn,anonymous:!0,exact:!0,hidden:!0},{name:"tags",path:"/tags",component:Ar,exact:!0,permission:Za.tags},{name:"activities",path:"/activities",component:Qr,exact:!0,permission:Za.activities},{name:"account",path:"/account",component:Ja,exact:!0}],ts="/",as=function(e){function t(e){var a;Object(n.a)(this,t),a=Object(s.a)(this,Object(i.a)(t).call(this,e));var r=new URL("https://vypadnivon.sk");return ts=r.pathname,a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.classes;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.a,{basename:ts},o.a.createElement(he,{user:t,routes:es},es.map(function(e){return e.anonymous?o.a.createElement(f.b,{key:e.name,path:e.path,exact:e.exact,component:e.component}):o.a.createElement(ns,{exact:e.exact,key:e.name,path:e.path,component:e.component,user:t,permission:e.permission})}))),o.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t.msg,autoHideDuration:6e3,onClose:t.hideMsg,ContentProps:{"aria-describedby":"message-id"},message:o.a.createElement("span",{id:"message-id"},t.msg),action:[o.a.createElement(g.a,{key:"close","aria-label":"Close",color:"inherit",className:a.close,onClick:t.hideMsg},o.a.createElement(y.a,null))]}))}}]),t}(o.a.Component);function ns(e){var t=e.component,a=e.user,n=e.permission,r=Object(d.a)(e,["component","user","permission"]);return o.a.createElement(f.b,Object.assign({},r,{render:function(e){return a.user?n&&!a.hasPermission(n)?o.a.createElement(f.a,{to:{pathname:na.home,state:{from:e.location}}}):o.a.createElement(t,e):o.a.createElement(f.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var rs=k(E()(function(e){return{close:{padding:e.spacing.unit/2}}}),j)(as);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ss,is=a(17),cs=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){var n,r=arguments;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>2&&void 0!==r[2]?r[2]:"",e.prev=1,e.next=4,is.auth.auth(t,a,n);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),e.t0;case 10:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t,a){return e.apply(this,arguments)}}(),ls=function(e){return"".concat("https://vypadnivon.sk","?provider=").concat(e)},os=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.oAuth(t,a,ls(t),na.configId);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),us=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.reset(t,"https://vypadnivon.sk");case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),ps=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.updateOauth(t,a,ls(t));case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),ds=function(){var e=Object(ye.a)(we.a.mark(function e(){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.generateSecret();case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),hs=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.sign(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),fs=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.verify(t,a);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),ms=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.getUsers(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),vs=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.getUserCached(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),bs=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.getUser(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),gs=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.auth.updateUser(t,a);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),ws=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={user:is.storage.getUser(),msg:null,users:{total:0,data:[]},secret:null,signature:null},a.showMsg=function(e){a.setState({msg:e})},a.showError=function(e){a.setState({msg:e.message})},a.hideMsg=function(){a.setState({msg:null})},a.auth=function(){var e=Object(ye.a)(we.a.mark(function e(t,n,r){var s;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,cs(t,n,r);case 3:return s=e.sent,a.setState({user:s}),e.abrupt("return",s);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.generateSecret=Object(ye.a)(we.a.mark(function e(){var t;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ds();case 3:t=e.sent,a.setState({secret:t}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])})),a.sign=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,hs(btoa(t));case 3:n=e.sent,a.setState({signature:n}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.verify=function(){var e=Object(ye.a)(we.a.mark(function e(t,n){var r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fs(t,n);case 3:r=e.sent,a.setState({signature:{data:r?atob(t):"NOT VALID",signature:n}}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),a.oAuth=function(){var e=Object(ye.a)(we.a.mark(function e(t,n){var r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,os(t,n);case 3:return r=e.sent,a.setState({user:r}),e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),a.updateOauth=function(){var e=Object(ye.a)(we.a.mark(function e(t,n){var r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ps(t,n);case 3:r=e.sent,a.setState({user:r}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),a.updateUser=function(){var e=Object(ye.a)(we.a.mark(function e(t,n){var r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,gs(t,n);case 3:return r=e.sent,a.setState({user:r}),e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),a.reset=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,us(t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),a.getUsers=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ms(t);case 3:n=e.sent,a.setState({users:n}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.hasPermission=function(e){return a.state.user&&(a.state.user.permissions&e)>0},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.children;return o.a.createElement(O.Provider,{value:Object(re.a)({auth:this.auth,hideMsg:this.hideMsg,showMsg:this.showMsg,showError:this.showError,generateSecret:this.generateSecret,oAuth:this.oAuth,updateOauth:this.updateOauth,getUsers:this.getUsers,getUser:bs,updateUser:this.updateUser,hasPermission:this.hasPermission,reset:this.reset,sign:this.sign,verify:this.verify},this.state)},e)}}]),t}(o.a.Component),ys=a(203),xs=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.date.setHours(0,0,0,0),e.next=5,is.store.post("timeRecords",t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),Es=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.start.setSeconds(0,0),t.end.setSeconds(0,0),e.next=6,is.store.post("events",t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),ks=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.post("enums",t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Os=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.collaborators=[].concat(Object(Ke.a)(t.collaborators),[a._id]),e.next=5,is.store.post("projects",t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),js=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,e.next=4,is.store.post("clients",t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),Cs=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.postFile(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),Ss=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.getFile(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),Ds=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.delFile(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),_s=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.date=new Date,e.next=5,is.store.getLocation();case 5:if(t.location=e.sent,!t._img){e.next=12;break}return e.next=9,Cs(t._img);case 9:n=e.sent,t.imgId=n._id,t._img=null;case 12:return e.next=14,is.store.post("tags",t);case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}},e,null,[[0,16]])}));return function(t,a){return e.apply(this,arguments)}}(),Ts=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.collaborators=[].concat(Object(Ke.a)(t.collaborators),[a._id]),e.next=4,is.store.put("projects",t,t._id);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),Is=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.date.setHours(0,0,0,0),e.next=4,is.store.put("timeRecords",t,t._id);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),Ns=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.put("events",t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Ps=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.put("enums",t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Fs=function(){var e=Object(ye.a)(we.a.mark(function e(){var t,a,n,r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=is.storage.getUser(),a={field:"_id",dir:"desc"},n=[{field:"collaborators",op:"eq",value:t._id}],e.next=6,is.store.get("projects",n,a);case 6:return(r=e.sent).data.forEach(function(e){e.collaborators=e.collaborators.filter(function(e){return e!==t._id})}),e.abrupt("return",r);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}(),Rs=function(){var e=Object(ye.a)(we.a.mark(function e(t,a){var n,r,s,i,c,l,o,u,p,d,h,f;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.getLocation();case 3:return(n=e.sent).max=null,r=Pt()().subtract(1,"day").toDate(),s=[].concat(Object(Ke.a)(t),[{field:"location",op:"near",value:n},{field:"date",op:"gt",value:r}]),i={field:"location",dir:"asc"},e.next=10,is.store.get("tags",s,i);case 10:(c=e.sent).filters=t,l=!0,o=!1,u=void 0,e.prev=15,p=c.data[Symbol.iterator]();case 17:if(l=(d=p.next()).done){e.next=30;break}return(h=d.value).date=h.date?new Date(h.date):null,h._dateStr=h.date.toLocaleString(),e.next=23,is.auth.getUserCached(h.userId);case 23:h._user=e.sent,f="",h.typesId.forEach(function(e,t){0!==t&&(f+=" | ");var n=a.find(function(t){return t._id===e});f+=n.name}),h._tagTypesStr=f;case 27:l=!0,e.next=17;break;case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(15),o=!0,u=e.t0;case 36:e.prev=36,e.prev=37,l||null==p.return||p.return();case 39:if(e.prev=39,!o){e.next=42;break}throw u;case 42:return e.finish(39);case 43:return e.finish(36);case 44:return e.abrupt("return",c);case 47:throw e.prev=47,e.t1=e.catch(0),e.t1;case 50:case"end":return e.stop()}},e,null,[[0,47],[15,32,36,44],[37,,39,43]])}));return function(t,a){return e.apply(this,arguments)}}(),Ls=function(e,t){switch(e.opField){case"dis":return"".concat(Math.round(t/100)/10," km");case"total_elevation_gain":return"".concat(t," m");case"moving_time":return function(e){var t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return a<10&&(a="0"+a),n<10&&(n="0"+n),"".concat(t,":").concat(a,":").concat(n)}(t);default:return t.toString()}},As=function(e,t){return function(e){var t=e.substring(0,4),a=e.substring(4,6),n=e.substring(6,8);return new Date(t,a,n)}(e.toString()).toLocaleString(t,{month:"long",year:"numeric"})},Ms=function(){var e=Object(ye.a)(we.a.mark(function e(t){var a;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.get("userClubs",[{field:"clubs",value:t}],{field:"_id",dir:"asc"},{limit:200,skip:0},["_id"]);case 3:return a=e.sent,e.abrupt("return",a.data.map(function(e){return e._id}));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Ws=function(){var e=Object(ye.a)(we.a.mark(function e(t,a,n,r,s){var i,c,l,o,u,p,d,h,f,m,v,b,g;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,i=!0,c=!1,l=void 0,e.prev=4,o=a[Symbol.iterator]();case 6:if(i=(u=o.next()).done){e.next=15;break}if(!((p=u.value).value instanceof Function)){e.next=12;break}return e.next=11,p.value();case 11:p.value=e.sent;case 12:i=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),c=!0,l=e.t0;case 21:e.prev=21,e.prev=22,i||null==o.return||o.return();case 24:if(e.prev=24,!c){e.next=27;break}throw l;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return e.next=31,is.store.aggregation("activities",t,a,r,n);case 31:d=e.sent,h=!0,f=!1,m=void 0,e.prev=35,v=d.data[Symbol.iterator]();case 37:if(h=(b=v.next()).done){e.next=50;break}if(g=b.value,"userId"!==t.field){e.next=45;break}return e.next=42,is.auth.getUserCached(g._id);case 42:g._user=e.sent,e.next=46;break;case 45:"month"===t.field?g._id=As(g._id,s):"year"===t.field&&(g._id=g._id.toString().substring(0,4));case 46:g.val=Ls(t,g.val);case 47:h=!0,e.next=37;break;case 50:e.next=56;break;case 52:e.prev=52,e.t1=e.catch(35),f=!0,m=e.t1;case 56:e.prev=56,e.prev=57,h||null==v.return||v.return();case 59:if(e.prev=59,!f){e.next=62;break}throw m;case 62:return e.finish(59);case 63:return e.finish(56);case 64:return e.abrupt("return",d);case 67:throw e.prev=67,e.t2=e.catch(0),e.t2;case 70:case"end":return e.stop()}},e,null,[[0,67],[4,17,21,29],[22,,24,28],[35,52,56,64],[57,,59,63]])}));return function(t,a,n,r,s){return e.apply(this,arguments)}}(),qs=function(){var e=Object(ye.a)(we.a.mark(function e(){var t;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.get("clients");case 3:return t=e.sent,e.abrupt("return",t);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),Us=function(){var e=Object(ye.a)(we.a.mark(function e(t){var a;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.getById("projects",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),zs=function(){var e=Object(ye.a)(we.a.mark(function e(t){var a;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.getById("clients",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Vs=function(){var e=Object(ye.a)(we.a.mark(function e(t){var a,n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={field:"date",op:"sum",opField:"duration"},e.next=4,is.store.aggregation("timeRecords",a,t);case 4:return(n=e.sent).sum=0,n.data.forEach(function(e){e.name=new Date(e._id).toLocaleDateString("en-US"),n.sum+=e.val}),e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),Bs=function(){var e=Object(ye.a)(we.a.mark(function e(t,a,n){var r,s,i,c,l,o,u,p;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={field:"date",dir:"desc"},e.next=4,is.store.get("timeRecords",a,r,n);case 4:s=e.sent,i=!0,c=!1,l=void 0,e.prev=8,o=we.a.mark(function e(){var a;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=p.value).date=a.date?new Date(a.date):null,a._project=t.find(function(e){return e._id===a.projectId}),!a.taskId){e.next=9;break}return e.next=6,li(a.taskId);case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0={name:null};case 10:return a._task=e.t0,e.next=13,is.auth.getUserCached(a.userId);case 13:a._user=e.sent;case 14:case"end":return e.stop()}},e)}),u=s.data[Symbol.iterator]();case 11:if(i=(p=u.next()).done){e.next=16;break}return e.delegateYield(o(),"t0",13);case 13:i=!0,e.next=11;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(8),c=!0,l=e.t1;case 22:e.prev=22,e.prev=23,i||null==u.return||u.return();case 25:if(e.prev=25,!c){e.next=28;break}throw l;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",s);case 33:throw e.prev=33,e.t2=e.catch(0),e.t2;case 36:case"end":return e.stop()}},e,null,[[0,33],[8,18,22,30],[23,,25,29]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Ks=function(){var e=Object(ye.a)(we.a.mark(function e(t,a,n){var r,s,i,c,l,o,u,p;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={field:"start",dir:"desc"},e.next=4,is.store.get("events",a,r,n);case 4:s=e.sent,i=!0,c=!1,l=void 0,e.prev=8,o=we.a.mark(function e(){var a;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=p.value).start=a.start?new Date(a.start):null,a.end=a.end?new Date(a.end):null,e.next=5,is.auth.getUserCached(a.userId);case 5:a._user=e.sent,a._eventType=t.find(function(e){return e._id===a.eventTypeId});case 7:case"end":return e.stop()}},e)}),u=s.data[Symbol.iterator]();case 11:if(i=(p=u.next()).done){e.next=16;break}return e.delegateYield(o(),"t0",13);case 13:i=!0,e.next=11;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(8),c=!0,l=e.t1;case 22:e.prev=22,e.prev=23,i||null==u.return||u.return();case 25:if(e.prev=25,!c){e.next=28;break}throw l;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",s);case 33:throw e.prev=33,e.t2=e.catch(0),e.t2;case 36:case"end":return e.stop()}},e,null,[[0,33],[8,18,22,30],[23,,25,29]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Ys=function(){var e=Object(ye.a)(we.a.mark(function e(t,a,n,r){var s,i,c,l,o,u,p;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.get("enums",a,n,r);case 3:for(s=e.sent,i=!0,c=!1,l=void 0,e.prev=7,o=function(){var e=p.value;e._enumType=t.find(function(t){return t._id===e.enumTypeId})},u=s.data[Symbol.iterator]();!(i=(p=u.next()).done);i=!0)o();e.next=16;break;case 12:e.prev=12,e.t0=e.catch(7),c=!0,l=e.t0;case 16:e.prev=16,e.prev=17,i||null==u.return||u.return();case 19:if(e.prev=19,!c){e.next=22;break}throw l;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.abrupt("return",s);case 27:throw e.prev=27,e.t1=e.catch(0),e.t1;case 30:case"end":return e.stop()}},e,null,[[0,27],[7,12,16,24],[17,,19,23]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),Gs=function(){var e=Object(ye.a)(we.a.mark(function e(t){var a,n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=[{field:"enumTypeId",value:t},{field:"disabled",op:"ne",value:!0}],e.next=4,is.store.get("enums",a);case 4:return n=e.sent,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),Hs=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.delById("timeRecords",t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Zs=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.delById("events",t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Js=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.delById("enums",t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Xs=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.delById("projects",t);case 3:return e.next=5,is.store.del("tasks",[{field:"projectId",value:t}]);case 5:return e.next=7,is.store.del("timeRecords",[{field:"projectId",value:t}]);case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),$s=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.delById("tasks",t);case 3:return e.next=5,is.store.del("timeRecords",[{field:"taskId",value:t}]);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Qs=function(){var e=Object(ye.a)(we.a.mark(function e(t,a,n){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.projectId=n,e.next=5,is.store.post("tasks",t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a,n){return e.apply(this,arguments)}}(),ei=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.put("tasks",t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),ti=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.put("clients",t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),ai=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.put("tags",t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),ni=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.delById("clients",t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),ri=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.delById("tags",t._id);case 3:if(!t.imgId){e.next=6;break}return e.next=6,Ds(t.imgId);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),si=function(){var e=Object(ye.a)(we.a.mark(function e(t,a,n,r){var s,i,c,l,o,u,p;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.get("tasks",a,r,n);case 3:s=e.sent,i=!0,c=!1,l=void 0,e.prev=7,o=we.a.mark(function e(){var a;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=p.value).assignedToId){e.next=7;break}return e.next=4,is.auth.getUserCached(a.assignedToId);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=null;case 8:a._assignedTo=e.t0,a._state=t.find(function(e){return e._id===a.stateId});case 10:case"end":return e.stop()}},e)}),u=s.data[Symbol.iterator]();case 10:if(i=(p=u.next()).done){e.next=15;break}return e.delegateYield(o(),"t0",12);case 12:i=!0,e.next=10;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(7),c=!0,l=e.t1;case 21:e.prev=21,e.prev=22,i||null==u.return||u.return();case 24:if(e.prev=24,!c){e.next=27;break}throw l;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return e.abrupt("return",s);case 32:throw e.prev=32,e.t2=e.catch(0),e.t2;case 35:case"end":return e.stop()}},e,null,[[0,32],[7,17,21,29],[22,,24,28]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),ii=function(){var e=Object(ye.a)(we.a.mark(function e(t){var a;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,is.store.getById("tasks",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),ci={},li=function(){var e=Object(ye.a)(we.a.mark(function e(t){return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,ci[t]){e.next=5;break}return e.next=4,ii(t);case 4:ci[t]=e.sent;case 5:return e.abrupt("return",ci[t]);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),oi=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).getProjects=Object(ye.a)(we.a.mark(function e(){var t;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{projects:Object(re.a)({},e.projects,{isLoading:!0})}}),e.next=4,Fs();case 4:(t=e.sent).isLoading=!1,a.setState({projects:t}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])})),a.getTags=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n,r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{tags:Object(re.a)({},e.tags,{isLoading:!0})}}),e.next=4,Gs(2);case 4:return n=e.sent,e.next=7,Rs(t,n.data);case 7:(r=e.sent).isLoading=!1,a.setState({tags:r,filteredEnums:n}),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(0),a.setState(function(e){return{tags:Object(re.a)({},e.tags,{isLoading:!1})}}),e.t0;case 16:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),a.getActivities=function(){var e=Object(ye.a)(we.a.mark(function e(t,n,r,s,i){var c;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{activities:Object(re.a)({},e.activities,{isLoading:!0})}}),e.next=4,Ws(t,n,r,s,i);case 4:(c=e.sent).isLoading=!1,a.setState({activities:c}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),a.setState(function(e){return{activities:Object(re.a)({},e.activities,{isLoading:!1})}}),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t,a,n,r,s){return e.apply(this,arguments)}}(),a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.getProject=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n,r,s,i,c,l,o,u,p;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Us(t);case 3:n=e.sent,r=[],s=!0,i=!1,c=void 0,e.prev=8,l=n.collaborators[Symbol.iterator]();case 10:if(s=(o=l.next()).done){e.next=19;break}return u=o.value,e.next=14,vs(u);case 14:p=e.sent,r.push(p);case 16:s=!0,e.next=10;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(8),i=!0,c=e.t0;case 25:e.prev=25,e.prev=26,s||null==l.return||l.return();case 28:if(e.prev=28,!i){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(25);case 33:a.setState({project:n,users:{total:r.length,data:r}}),e.next=39;break;case 36:throw e.prev=36,e.t1=e.catch(0),e.t1;case 39:case"end":return e.stop()}},e,null,[[0,36],[8,21,25,33],[26,,28,32]])}));return function(t){return e.apply(this,arguments)}}(),a.getClient=function(){var e=Object(ye.a)(we.a.mark(function e(t){var n;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,zs(t);case 3:n=e.sent,a.setState({client:n}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.getClients=Object(ye.a)(we.a.mark(function e(){var t;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{clients:Object(re.a)({},e.clients,{isLoading:!0})}}),e.next=4,qs();case 4:(t=e.sent).isLoading=!1,a.setState({clients:t}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])})),a.refreshTimeRecords=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i,c;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{timeRecords:Object(re.a)({},e.timeRecords,{isLoading:!0})}}),t=a.state.timeRecords,n=t.filters,r=t.page,e.next=5,Fs();case 5:return s=e.sent,e.next=8,Bs(s.data,n,r);case 8:return i=e.sent,e.next=11,Vs(n);case 11:c=e.sent,i.isLoading=!1,a.setState({timeRecords:i,stats:c,projects:s}),e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}},e,null,[[0,16]])})),a.refreshEvents=Object(ye.a)(we.a.mark(function e(){var t,n,r,s;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{events:Object(re.a)({},e.events,{isLoading:!0})}}),t=a.state.events,n=t.filters,r=t.page,e.next=5,Ks(a.state.filteredEnums.data,n,r);case 5:(s=e.sent).isLoading=!1,a.setState({events:s}),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,10]])})),a.getEvents=function(){var e=Object(ye.a)(we.a.mark(function e(t,n){var r,s,i;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{events:Object(re.a)({},e.events,{isLoading:!0})}}),e.next=4,ms([]);case 4:return r=e.sent,e.next=7,Gs(1);case 7:return s=e.sent,e.next=10,Ks(s.data,t,n);case 10:return(i=e.sent).isLoading=!1,a.setState({events:i,users:r,filteredEnums:s}),e.abrupt("return",i);case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}},e,null,[[0,16]])}));return function(t,a){return e.apply(this,arguments)}}(),a.getEnums=function(){var e=Object(ye.a)(we.a.mark(function e(t,n,r){var s;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{enums:Object(re.a)({},e.events,{isLoading:!0})}}),e.next=4,Ys(a.state.enumTypes.data,t,n,r);case 4:return(s=e.sent).isLoading=!1,a.setState({enums:s}),e.abrupt("return",s);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.refreshEnums=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{events:Object(re.a)({},e.events,{isLoading:!0})}}),t=a.state.enums,n=t.filters,r=t.sort,s=t.page,e.next=5,Ys(a.state.enumTypes.data,n,r,s);case 5:(i=e.sent).isLoading=!1,a.setState({enums:i}),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,10]])})),a.refreshTasks=Object(ye.a)(we.a.mark(function e(){var t,n,r,s,i,c;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{tasks:Object(re.a)({},e.tasks,{isLoading:!0})}}),t=a.state.tasks,n=t.filters,r=t.page,s=t.sort,i=a.state.states.data,e.next=6,si(i,n,r,s);case 6:(c=e.sent).isLoading=!1,a.setState({tasks:c}),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}},e,null,[[0,11]])})),a.getTasks=function(){var e=Object(ye.a)(we.a.mark(function e(t,n,r,s){var i,c,l;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{tasks:Object(re.a)({},e.tasks,{isLoading:!0})}}),i=[].concat(Object(Ke.a)(n),[{field:"projectId",op:"eq",value:t}]),c=a.state.states.data,e.next=6,si(c,i,r,s);case 6:return(l=e.sent).isLoading=!1,a.setState({tasks:l}),e.abrupt("return",l);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),a.getOpenedTasks=function(){var e=Object(ye.a)(we.a.mark(function e(t,n){var r;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=[{field:"stateId",op:"ne",value:3},{field:"assignedToId",value:n._id}],e.next=4,a.getTasks(t,r,void 0);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.likeTag=function(e,t){a.setState(function(a){return{tags:Object(re.a)({},a.tags,{data:a.tags.data.map(function(a){if(a._id===e){var n=a.likes.indexOf(t._id);n>-1?(a.likes.splice(n,1),a.likesCnt=a.likesCnt-1):(a.likes.push(t._id),a.likesCnt=a.likesCnt+1),ai(a)}return a})})}})},a.getTimeRecords=function(){var e=Object(ye.a)(we.a.mark(function e(t,n){var r,s,i,c,l;return we.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{timeRecords:Object(re.a)({},e.timeRecords,{isLoading:!0})}}),e.next=4,Fs();case 4:return r=e.sent,e.next=7,ms([]);case 7:return s=e.sent,i=[].concat(Object(Ke.a)(t),[{field:"projectId",op:"in",value:r.data.map(function(e){return e._id})}]),e.next=11,Bs(r.data,i,n);case 11:return c=e.sent,e.next=14,Vs(i);case 14:return l=e.sent,c.isLoading=!1,a.setState({timeRecords:c,stats:l,projects:r,users:s}),e.abrupt("return",c);case 20:throw e.prev=20,e.t0=e.catch(0),e.t0;case 23:case"end":return e.stop()}},e,null,[[0,20]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleChangeCollection=function(e){console.log("CHANGED: "+e)},a.state={timeRecords:{total:0,data:[],filters:[],page:null,isLoading:!1},events:{total:0,data:[],filters:[],page:null,isLoading:!1},enums:{total:0,data:[],filters:[],page:null,isLoading:!1},filteredEnums:{total:0,data:[]},projects:{total:0,data:[],filters:[],isLoading:!1},project:null,client:null,stats:[],users:{total:0,data:[]},tasks:{total:0,data:[],isLoading:!1},clients:{total:0,data:[],isLoading:!1},states:{total:3,data:[{_id:1,name:"To do"},{_id:2,name:"Doing"},{_id:3,name:"Done"}]},enumTypes:{total:2,data:[{_id:1,name:"event"},{_id:2,name:"tag"}]},projectId:null,tags:{total:0,data:[],filters:[],isLoading:!1},activities:{total:0,data:[],isLoading:!1}},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.children;return!ss&&is.storage.getUser()&&(ss=!0,function(e){var t=(new ys.a).withUrl("".concat(na.url.store,"/hub"),{accessTokenFactory:function(){return is.storage.getUser().refreshToken}}).configureLogging(ys.b.Error).build();t.start().catch(function(e){console.error(e)}),t.on("change",e)}(this.handleChangeCollection)),o.a.createElement(qe.Provider,{value:Object(re.a)({addTimeRecord:xs,addEvent:Es,getTimeRecords:this.getTimeRecords,getEvents:this.getEvents,refreshEvents:this.refreshEvents,refreshTimeRecords:this.refreshTimeRecords,deleteTimeRecord:Hs,deleteEvent:Zs,addProject:Os,addClient:js,addTag:_s,getClients:this.getClients,editClient:ti,editTag:ai,deleteClient:ni,getProjects:this.getProjects,deleteProject:Xs,deleteTag:ri,addTask:Qs,editTask:ei,deleteTask:$s,refreshTasks:this.refreshTasks,editProject:Ts,editTimeRecord:Is,editEvent:Ns,getTasks:this.getTasks,getProject:this.getProject,getClient:this.getClient,getOpenedTasks:this.getOpenedTasks,handleChange:this.handleChange,getTags:this.getTags,likeTag:this.likeTag,getActivities:this.getActivities,getFile:Ss,getUsersInClub:Ms,getEnums:this.getEnums,refreshEnums:this.refreshEnums,addEnum:ks,editEnum:Ps,deleteEnum:Js},this.state)},e)}}]),t}(o.a.Component),ui=a(343),pi=a(344),di=a(345);Object(is.init)(na);var hi=Object(te.createMuiTheme)({palette:na.palette}),fi=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.documentElement.style.setProperty("--primary-color",na.palette.primary.main),document.title="".concat("vypadnivon"," v").concat("0.3.3")}},{key:"render",value:function(){return o.a.createElement(ws,null,o.a.createElement(oi,null,o.a.createElement(ue,{locale:na.locale,"en-US":pi,"sk-SK":di},o.a.createElement(te.MuiThemeProvider,{theme:hi},o.a.createElement(xe.c,{utils:ui.a},o.a.createElement(rs,null))))))}}]),t}(o.a.Component);p.a.render(o.a.createElement(fi,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[375,1,2]]]);
//# sourceMappingURL=main.09e0803e.chunk.js.map